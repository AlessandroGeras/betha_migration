const sql = require('mssql');
const dotenv = require('dotenv');
const fetch = require('node-fetch');
const fs = require('fs');

dotenv.config();

async function connectToSqlServer() {
    try {
        const server = process.env.SERVER;
        const database = process.env.DATABASE;
        const username = process.env.USERNAME_SQLSERVER;
        const password = process.env.PASSWORD;

        const config = {
            user: username,
            password: password,
            server: server,
            database: database,
            options: {
                encrypt: false
            }
        };

        const pool = await sql.connect(config);
        console.log("Conectado ao SQL Server");
        return pool;
    } catch (error) {
        console.error('Erro ao conectar ao SQL Server:', error);
        throw error;
    }
}

function formatDate(date) {
    const d = new Date(date);
    const year = d.getFullYear();
    const month = (`0${d.getMonth() + 1}`).slice(-2);
    const day = (`0${d.getDate()}`).slice(-2);
    const hours = (`0${d.getHours()}`).slice(-2);
    const minutes = (`0${d.getMinutes()}`).slice(-2);
    const seconds = (`0${d.getSeconds()}`).slice(-2);
    return `${year}-${month}-${day}`;
    //return `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;
}

async function main() {
    try {
        // Conectar ao SQL Server
        const masterConnection = await connectToSqlServer();

        // Selecionar o banco de dados "CONTABIL2024"
        const selectDatabaseQuery = 'USE CONTABIL2024';
        await masterConnection.query(selectDatabaseQuery);

        // Executar a consulta SQL
        const userQuery = `
            select 
ROW_NUMBER() OVER (ORDER BY ct.cd_CategoriaEconomicaDespesa) AS idIntegracao,
JSON_QUERY(
(SELECT

           ct. cd_exercicio as exercicio,
           ct. dt_emissao as data,
		   ct. dt_vencimento as dataVencimento,
		    JSON_QUERY(
(SELECT 

case REPLACE(REPLACE(REPLACE([ds_cgc],'.', ''),'-', ''),'/', '')

 when '04094364293' then 6113563
 when '93279639204' then 6113592
 when '30401089215' then 6113603
 when '15656112845' then 6113742
 when '78696879287' then 6113889
 when '69868646200' then 6384528
 when '27226271249' then 6385232
 when '37987658120' then 6385233
 when '59566159234' then 6385234
 when '47046104204' then 6385235
 when '68957491520' then 6385236
 when '76457540287' then 6385237
 when '58981969272' then 6385238
 when '71021140287' then 6385239
 when '31690521287' then 6385240
 when '20423381253' then 6385241
 when '60708263291' then 6385242
 when '40842681272' then 6385243
 when '27727157287' then 6385244
 when '34120726215' then 6385245
 when '64355861287' then 6385246
 when '47046651272' then 6385247
 when '00281124582' then 6385248
 when '16663861115' then 6385249
 when '69037302220' then 6385250
 when '46918280287' then 6385251
 when '03160716767' then 6385252
 when '84880570249' then 6385253
 when '39058476200' then 6385254
 when '92212573553' then 6385255
 when '90603532268' then 6385256
 when '65183835268' then 6385257
 when '31228879249' then 6385258
 when '73520764253' then 6385259
 when '01853094960' then 6385260
 when '62302914287' then 6385261
 when '63873842220' then 6385262
 when '00919619207' then 6385263
 when '45689920282' then 6385264
 when '87496372234' then 6385265
 when '60049227220' then 6385266
 when '64870839253' then 6385267
 when '93612184253' then 6385268
 when '34121110234' then 6385269
 when '40879224215' then 6385270
 when '27765610163' then 6385271
 when '35069171291' then 6385272
 when '45758514268' then 6385273
 when '79872956200' then 6385274
 when '35068590215' then 6385275
 when '62962833268' then 6385276
 when '52440850934' then 6385277
 when '47892498249' then 6385278
 when '41935098268' then 6385279
 when '62282433220' then 6385280
 when '38949687291' then 6385289
 when '42004080159' then 6385290
 when '62256793249' then 6385291
 when '85450383215' then 6385292
 when '85569151249' then 6385293
 when '70382565215' then 6385294
 when '30405092920' then 6385295
 when '66151945204' then 6385296
 when '56197730278' then 6385297
 when '66306523200' then 6385298
 when '26066483234' then 6385299
 when '02090068205' then 6385300
 when '61043923268' then 6385301
 when '42131278500' then 6385303
 when '71590188268' then 6385304
 when '65134893268' then 6385305
 when '76252230278' then 6385306
 when '21856656268' then 6385307
 when '77107241249' then 6385308
 when '02850118478' then 6385309
 when '32776608934' then 6385310
 when '83790365220' then 6385311
 when '35127376253' then 6385312
 when '96626534220' then 6385313
 when '31296882268' then 6385314
 when '73164941820' then 6385315
 when '00198457235' then 6385316
 when '00277068266' then 6385317
 when '70898812968' then 6385318
 when '68698615287' then 6385319
 when '76437574291' then 6385320
 when '35069112287' then 6385321
 when '64746852200' then 6385322
 when '25041215120' then 6385323
 when '01283887142' then 6385324
 when '84094532749' then 6385325
 when '25216899120' then 6385326
 when '32545762253' then 6385327
 when '42025826249' then 6385328
 when '58860959934' then 6385329
 when '97817643768' then 6385330
 when '31541682220' then 6385331
 when '59542306253' then 6385332
 when '99468794253' then 6385333
 when '10311386253' then 6385334
 when '42202957200' then 6113378
 when '63921294215' then 6385335
 when '00364093242' then 6385336
 when '71111697272' then 6385337
 when '01445461242' then 6385338
 when '39022692272' then 6386117
 when '69935327272' then 6386118
 when '00623421267' then 6386119
 when '35143339200' then 6386120
 when '63472040297' then 6386121
 when '01206619260' then 6386122
 when '61847143253' then 6386123
 when '77916034204' then 6386124
 when '71753834287' then 6386125
 when '82190283272' then 6386126
 when '49977938920' then 6386127
 when '93279647215' then 6386128
 when '61150029234' then 6386129
 when '90951069268' then 6386130
 when '01836434537' then 6386131
 when '76558592215' then 6386132
 when '68491891234' then 6386133
 when '52312402220' then 6386134
 when '02540867219' then 6386135
 when '59287900230' then 6386136
 when '00438748271' then 6386137
 when '29795028200' then 6386138
 when '57290512200' then 6386139
 when '03172174298' then 6386140
 when '00634753240' then 6386141
 when '01830361236' then 6386142
 when '28295771833' then 6386143
 when '71664602291' then 6386144
 when '74893300253' then 6386145
 when '63248980249' then 6386146
 when '24891622253' then 6386147
 when '00851748236' then 6386148
 when '63883317268' then 6386149
 when '98000144204' then 6386150
 when '04226144244' then 6386152
 when '59536314215' then 6386153
 when '69449457204' then 6386154
 when '94736979291' then 6386155
 when '33394679272' then 6386156
 when '57003262215' then 6386157
 when '01582272204' then 6386158
 when '29461480253' then 6386159
 when '01241780226' then 6386160
 when '76437337249' then 6386161
 when '02043348299' then 6386162
 when '67879080244' then 6386163
 when '12561307700' then 6386164
 when '81085400204' then 6386165
 when '94620385204' then 6386166
 when '02715137214' then 6386167
 when '02338065204' then 6386169
 when '55950647220' then 6386170
 when '63875942272' then 6386171
 when '11367156220' then 6386172
 when '97027456249' then 6386173
 when '03570707202' then 6386174
 when '65411692253' then 6386175
 when '70271212209' then 6386176
 when '01986542785' then 6386177
 when '76436314253' then 6386178
 when '00681099208' then 6386179
 when '01208122231' then 6386180
 when '74206141215' then 6386181
 when '93415940225' then 6386182
 when '69948267249' then 6386183
 when '79446418291' then 6386184
 when '03675621979' then 6386185
 when '61131580206' then 6386186
 when '01271556278' then 6386187
 when '35068663204' then 6386188
 when '82934240282' then 6386189
 when '04226195230' then 6386190
 when '47869178268' then 6386191
 when '52345327200' then 6386192
 when '01206627280' then 6386193
 when '60451866215' then 6386194
 when '05185295252' then 6386195
 when '56470592287' then 6386196
 when '63257262191' then 6386197
 when '02824575263' then 6386198
 when '00809175266' then 6386199
 when '01336217235' then 6386200
 when '02600908242' then 6386201
 when '96385766268' then 6386202
 when '01053381255' then 6386203
 when '04658081237' then 6386204
 when '06805347254' then 6386205
 when '67005144287' then 6386206
 when '34029850200' then 6386207
 when '79554091249' then 6386208
 when '01031443231' then 6386209
 when '40024393215' then 6386210
 when '99825643234' then 6386211
 when '01766403204' then 6386212
 when '06120230289' then 6386213
 when '02583568205' then 6386214
 when '01368626246' then 6386215
 when '69152683168' then 6386216
 when '05172260900' then 6386217
 when '67388973249' then 6386219
 when '01253937257' then 6386220
 when '00948652217' then 6386221
 when '01774029200' then 6386222
 when '70507252268' then 6386223
 when '02372437259' then 6386224
 when '56627505215' then 6386225
 when '69819149215' then 6386226
 when '74102206604' then 6386227
 when '68056052291' then 6386228
 when '74815091234' then 6386229
 when '86605925220' then 6386230
 when '69100136204' then 6386231
 when '61110949200' then 6386232
 when '85931721215' then 6386233
 when '46903046291' then 6386234
 when '61091537291' then 6386235
 when '68641729291' then 6386236
 when '61014494087' then 6386237
 when '01299647278' then 6386238
 when '94721815204' then 6386239
 when '58913084953' then 6386240
 when '34970347204' then 6386241
 when '59963409253' then 6386242
 when '00101865228' then 6386243
 when '90161092268' then 6386244
 when '02157650288' then 6386245
 when '60252375220' then 6386246
 when '01447582292' then 6386247
 when '21333467591' then 6386248
 when '88745813272' then 6386249
 when '60072067268' then 6386250
 when '74946528253' then 6386251
 when '64178935291' then 6386252
 when '00689397283' then 6386253
 when '01157069258' then 6386254
 when '24877700234' then 6386255
 when '84979925200' then 6386256
 when '02948059232' then 6386257
 when '00202933210' then 6386258
 when '75548828215' then 6386259
 when '58177132253' then 6386260
 when '67241239253' then 6386261
 when '00577635263' then 6386262
 when '03748355270' then 6386263
 when '02290149250' then 6386264
 when '00576599239' then 6386265
 when '00932084214' then 6386266
 when '02152311205' then 6386267
 when '64418391215' then 6386268
 when '00599047208' then 6386269
 when '84829591234' then 6386270
 when '65903064272' then 6386271
 when '98188984272' then 6386272
 when '00452101280' then 6386273
 when '63900882215' then 6386274
 when '02355470260' then 6386275
 when '97537250197' then 6386276
 when '68402279287' then 6386277
 when '98785168220' then 6386278
 when '08403426160' then 6386279
 when '79127274268' then 6386280
 when '01554065232' then 6386281
 when '00485384264' then 6386282
 when '03625602261' then 6386283
 when '89225910215' then 6386284
 when '02019958244' then 6386285
 when '02986504280' then 6386286
 when '84960906987' then 6386287
 when '34121102215' then 6386288
 when '00196382211' then 6386289
 when '84131055287' then 6386290
 when '05196575278' then 6386291
 when '84294051272' then 6386292
 when '01452999295' then 6386293
 when '02097089216' then 6386294
 when '64068633215' then 6386295
 when '03018988205' then 6386296
 when '40840263287' then 6386297
 when '40842312234' then 6386298
 when '01215168225' then 6386299
 when '04227538238' then 6386300
 when '87564980206' then 6386301
 when '68736959200' then 6386302
 when '46921214249' then 6386303
 when '06772955102' then 6386304
 when '70279085222' then 6386305
 when '00592693244' then 6386306
 when '03371227502' then 6386307
 when '08513294209' then 6386308
 when '02794142267' then 6386309
 when '92956122134' then 6386310
 when '05464713239' then 6386311
 when '71120920272' then 6386312
 when '68913702215' then 6386313
 when '91391407253' then 6386314
 when '00748905227' then 6386315
 when '02571105264' then 6386316
 when '70394105249' then 6386317
 when '92375367472' then 6386318
 when '96124520249' then 6387055
 when '63889978215' then 6387056
 when '22913220282' then 6387057
 when '79812317872' then 6387058
 when '25613235287' then 6387059
 when '76457648215' then 6387060
 when '13096311820' then 6387061
 when '51787792153' then 6387062
 when '27702936215' then 6387063
 when '83775404287' then 6387064
 when '69657459249' then 6387065
 when '20389760153' then 6387066
 when '56569378287' then 6387067
 when '67242286204' then 6387068
 when '00599022566' then 6387069
 when '40024539287' then 6387070
 when '82970319934' then 6387071
 when '46880968287' then 6387072
 when '84568976200' then 6387073
 when '84601035600' then 6387074
 when '06396180812' then 6387078
 when '13949276572' then 6387079
 when '38547783253' then 6387080
 when '60697610225' then 6387081
 when '20461755572' then 6387082
 when '21322467501' then 6387083
 when '74986228234' then 6387084
 when '77161556104' then 6387085
 when '76436217215' then 6387086
 when '23456370997' then 6387087
 when '74106376253' then 6387088
 when '14603527934' then 6387089
 when '69884153272' then 6387090
 when '51613280610' then 6387091
 when '57374961634' then 6387092
 when '65745299215' then 6387093
 when '06608569807' then 6387094
 when '71130306291' then 6387095
 when '69104298268' then 6387096
 when '73664960220' then 6387097
 when '23623055204' then 6387098
 when '20329601253' then 6387099
 when '42488303453' then 6387100
 when '58946624272' then 6387101
 when '59121696934' then 6387102
 when '91247349268' then 6387103
 when '65497317200' then 6387104
 when '01946693278' then 6387105
 when '00948643226' then 6387106
 when '61542563291' then 6387108
 when '83043810287' then 6387109
 when '63050404272' then 6387110
 when '68414501249' then 6387111
 when '68575556215' then 6387112
 when '49941976287' then 6387113
 when '76435989249' then 6387114
 when '23644370249' then 6387115
 when '61045934291' then 6387116
 when '59683651100' then 6387117
 when '11945668806' then 6387118
 when '47927992287' then 6387119
 when '02540654223' then 6387120
 when '42025206291' then 6387121
 when '36735280920' then 6387122
 when '21287937934' then 6387123
 when '41944224220' then 6387124
 when '29283647220' then 6387125
 when '69172501200' then 6387126
 when '13493094515' then 6387127
 when '30147131120' then 6387128
 when '05244673904' then 6387129
 when '89178203287' then 6387130
 when '84122510759' then 6387131
 when '76398978234' then 6387132
 when '00894692240' then 6387133
 when '84568992249' then 6387134
 when '00261402250' then 6387135
 when '60428902987' then 6387136
 when '06838669153' then 6387137
 when '28232640278' then 6387138
 when '42149886200' then 6387139
 when '75808854253' then 6387140
 when '98843451553' then 6387141
 when '68715900215' then 6387142
 when '49768450282' then 6387143
 when '08466912215' then 6387144
 when '87565072249' then 6387145
 when '39296105587' then 6387146
 when '40840018215' then 6387147
 when '79300430297' then 6387148
 when '69537232204' then 6387149
 when '87900483268' then 6387150
 when '35999268915' then 6387151
 when '29540211875' then 6387152
 when '79422004268' then 6387153
 when '86353411200' then 6387154
 when '38950251272' then 6387155
 when '14169720210' then 6387156
 when '57043302234' then 6387157
 when '68455356200' then 6387158
 when '00924612207' then 6387159
 when '01154976254' then 6387160
 when '92233368568' then 6387161
 when '27191621249' then 6387162
 when '56539479204' then 6387163
 when '81655487868' then 6387164
 when '76911543215' then 6387165
 when '39017044268' then 6387166
 when '00622657259' then 6387167
 when '31949843572' then 6387168
 when '24879053287' then 6387169
 when '29280958291' then 6387170
 when '02234850207' then 6387171
 when '02335998510' then 6387172
 when '21610240600' then 6387173
 when '32611471215' then 6387174
 when '31692966200' then 6387175
 when '58922440244' then 6387176
 when '68737971204' then 6387177
 when '03191016732' then 6387178
 when '88802078068' then 6387179
 when '90989775100' then 6387180
 when '48828750987' then 6387181
 when '63208130244' then 6387182
 when '64647340244' then 6387183
 when '40842215204' then 6387184
 when '65749820220' then 6387185
 when '72118806272' then 6387186
 when '25109421234' then 6387187
 when '60218851200' then 6387188
 when '19116276272' then 6387189
 when '20962657972' then 6387190
 when '71962964272' then 6387191
 when '00948656204' then 6387192
 when '02938750650' then 6387193
 when '62331469253' then 6387194
 when '52429083272' then 6387195
 when '27257576220' then 6387196
 when '02504509251' then 6387197
 when '64113884404' then 6387198
 when '26701782272' then 6387199
 when '59987685234' then 6387200
 when '03249671282' then 6387201
 when '77168046268' then 6387202
 when '96141859291' then 6387203
 when '98384880204' then 6387204
 when '42183669268' then 6387205
 when '86718622249' then 6387206
 when '32557337900' then 6387207
 when '81671199200' then 6387208
 when '98161016291' then 6387209
 when '45694680200' then 6387210
 when '03778279246' then 6387211
 when '78570549253' then 6387212
 when '02853322289' then 6387213
 when '02354792840' then 6387214
 when '41934911291' then 6387215
 when '03223838201' then 6387216
 when '24246107204' then 6387217
 when '00481103295' then 6387218
 when '28650395287' then 6387219
 when '39024091268' then 6387220
 when '04143862212' then 6387221
 when '75368897200' then 6387222
 when '90446151220' then 6387223
 when '74781570259' then 6387224
 when '00003574210' then 6387225
 when '42246504287' then 6387226
 when '46931074253' then 6387227
 when '30711118272' then 6387228
 when '83790349291' then 6387229
 when '29811740291' then 6387230
 when '05987002265' then 6387231
 when '95843787249' then 6387232
 when '86781383272' then 6387233
 when '93158610272' then 6387234
 when '91216150206' then 6387235
 when '47881437200' then 6387236
 when '72137762234' then 6387237
 when '02465077210' then 6387238
 when '17558930197' then 6387239
 when '00199458251' then 6387240
 when '72447079249' then 6387241
 when '47050101249' then 6387242
 when '07422925256' then 6387243
 when '00765468298' then 6387244
 when '79055583200' then 6387245
 when '39070719215' then 6387246
 when '08672785282' then 6387247
 when '81463596200' then 6387248
 when '11626791660' then 6387249
 when '42025524234' then 6387250
 when '62249592268' then 6387251
 when '02382891254' then 6387252
 when '04363691255' then 6387253
 when '01278056211' then 6387255
 when '07285672297' then 6387256
 when '80271553200' then 6387257
 when '06116349293' then 6387258
 when '27138046120' then 6387259
 when '01208124285' then 6387262
 when '93263325272' then 6387263
 when '05225785271' then 6387264
 when '14191717200' then 6387265
 when '04363706201' then 6387266
 when '01016001274' then 6387267
 when '01308795254' then 6387268
 when '85268658204' then 6387269
 when '99323818291' then 6387270
 when '77686543234' then 6387271
 when '01206612258' then 6387272
 when '56936494234' then 6387273
 when '07040922207' then 6387274
 when '60664940234' then 6387275
 when '70271223243' then 6387276
 when '01077124155' then 6387277
 when '47930470253' then 6387278
 when '08565343235' then 6387279
 when '63881853200' then 6387280
 when '96205733234' then 6387281
 when '64368424204' then 6387282
 when '70271447273' then 6387283
 when '22913556272' then 6387284
 when '13915886220' then 6387285
 when '63515172220' then 6387286
 when '70388091215' then 6387287
 when '80970680287' then 6387288
 when '07132654934' then 6387289
 when '74136100272' then 6387290
 when '24210358215' then 6387291
 when '01921466294' then 6387292
 when '64903060187' then 6387293
 when '39016374272' then 6387294
 when '56195630225' then 6387295
 when '53163125115' then 6387296
 when '00217605273' then 6387297
 when '45913471172' then 6387298
 when '35171340234' then 6387299
 when '05674916250' then 6387300
 when '69626200987' then 6387301
 when '62476270253' then 6387302
 when '81641273291' then 6387303
 when '00948658258' then 6387304
 when '05725888282' then 6387305
 when '74743589215' then 6387306
 when '01385146230' then 6387307
 when '26998270100' then 6387309
 when '17732590244' then 6387310
 when '61047279991' then 6387311
 when '71120785200' then 6387312
 when '71233962272' then 6387313
 when '02724725816' then 6387314
 when '10139885900' then 6387315
 when '84135000282' then 6387316
 when '46879030297' then 6387317
 when '75517612253' then 6387318
 when '17766842572' then 6387319
 when '01686474865' then 6387320
 when '76031403234' then 6387321
 when '21879708841' then 6387322
 when '65697448287' then 6387323
 when '88268586249' then 6387324
 when '77107322249' then 6387325
 when '99336430106' then 6387326
 when '09092455172' then 6387327
 when '90597206287' then 6387328
 when '67385583253' then 6387329
 when '87496313220' then 6387330
 when '29059317874' then 6387331
 when '05588785630' then 6387332
 when '00078657164' then 6387333
 when '53402235234' then 6387334
 when '47045833253' then 6387335
 when '83839500206' then 6387336
 when '89730550204' then 6387337
 when '03301750923' then 6387338
 when '70406090297' then 6387339
 when '86295900259' then 6387340
 when '28664353204' then 6387341
 when '24847224272' then 6387342
 when '87496100234' then 6387343
 when '06571711150' then 6387344
 when '82610320272' then 6387345
 when '27439708806' then 6387346
 when '81877099287' then 6387347
 when '62965638253' then 6387348
 when '10636099253' then 6387349
 when '68206313249' then 6387350
 when '90710630204' then 6387351
 when '10651659272' then 6387352
 when '83549200200' then 6387353
 when '01206615273' then 6387354
 when '12381969420' then 6387355
 when '94580812204' then 6387356
 when '39060055268' then 6387357
 when '13951505249' then 6387358
 when '06789598111' then 6387359
 when '72447125291' then 6387360
 when '07824450120' then 6387361
 when '20640439187' then 6387362
 when '00893782297' then 6387363
 when '42594014249' then 6387364
 when '86936182291' then 6387365
 when '89310020253' then 6387366
 when '83518614215' then 6387367
 when '28223063204' then 6387368
 when '00461145219' then 6387369
 when '82221227204' then 6387370
 when '80063616220' then 6387371
 when '01495753271' then 6387372
 when '63186462215' then 6387373
 when '71970100206' then 6387374
 when '08108887186' then 6387375
 when '00548849269' then 6387376
 when '01203560230' then 6387377
 when '37468292833' then 6387379
 when '78204224249' then 6387380
 when '71231633204' then 6387381
 when '93921853249' then 6387382
 when '99618648249' then 6387383
 when '02553832230' then 6387384
 when '86174975215' then 6387385
 when '03733678214' then 6387386
 when '01613844204' then 6387387
 when '71339973200' then 6387388
 when '04227771293' then 6387389
 when '01687388806' then 6387390
 when '01006351213' then 6387391
 when '40842096272' then 6387392
 when '01053380283' then 6387393
 when '60412577291' then 6387394
 when '61274887291' then 6387395
 when '00913355232' then 6387396
 when '65850718249' then 6387397
 when '34872817249' then 6387398
 when '23916249215' then 6387399
 when '23044149827' then 6387400
 when '55883206204' then 6387401
 when '63902648287' then 6387402
 when '52308448920' then 6387403
 when '20467303215' then 6387404
 when '72947764234' then 6387405
 when '99283247272' then 6387406
 when '08067083878' then 6387407
 when '07640444780' then 6387408
 when '92798403200' then 6387409
 when '92347800272' then 6387410
 when '45699585249' then 6387411
 when '98290851200' then 6387412
 when '85875902272' then 6387413
 when '01193380251' then 6387414
 when '87496089249' then 6387415
 when '99323834220' then 6387416
 when '20660901153' then 6387417
 when '73122505215' then 6387419
 when '87187850263' then 6387420
 when '61797685953' then 6387421
 when '02290024201' then 6387422
 when '63510120230' then 6387423
 when '01680180207' then 6387424
 when '87095696187' then 6387425
 when '12175080153' then 6387426
 when '47906731204' then 6387427
 when '02948341256' then 6387428
 when '39029514272' then 6387429
 when '58118276953' then 6387430
 when '88607020200' then 6387431
 when '80254160972' then 6387432
 when '20134746104' then 6387433
 when '88672840968' then 6387434
 when '21882231287' then 6387435
 when '45724610230' then 6387436
 when '81965257291' then 6387437
 when '03574091249' then 6387438
 when '34115161272' then 6387439
 when '82469342287' then 6387440
 when '62347942204' then 6387441
 when '30372879187' then 6387442
 when '59229284220' then 6387443
 when '24847348249' then 6387444
 when '73185426215' then 6387445
 when '69225044291' then 6387446
 when '02412639213' then 6387447
 when '36571822920' then 6387448
 when '58071539287' then 6387449
 when '00821953907' then 6387450
 when '21573758809' then 6387451
 when '04302382660' then 6387452
 when '94697817249' then 6387453
 when '79769497215' then 6387454
 when '00661238288' then 6387455
 when '01237633206' then 6387456
 when '04839169942' then 6387457
 when '83670190244' then 6387458
 when '02041473282' then 6387459
 when '29427584149' then 6387460
 when '99680440249' then 6387461
 when '02093662221' then 6387462
 when '70271268263' then 6387463
 when '04612384202' then 6387464
 when '82509255215' then 6387465
 when '03714840222' then 6387466
 when '17142328835' then 6387467
 when '21572356120' then 6387468
 when '01547048220' then 6387469
 when '59556609253' then 6387470
 when '69171068287' then 6387471
 when '03446184201' then 6387472
 when '94982740100' then 6387473
 when '40842428291' then 6387474
 when '87564890215' then 6387475
 when '01053379277' then 6387476
 when '00193033275' then 6387477
 when '54210291900' then 6387478
 when '82180237987' then 6387479
 when '02740223200' then 6387480
 when '66917468215' then 6387481
 when '80407013253' then 6387482
 when '84298863204' then 6387483
 when '98183079172' then 6387484
 when '74946528253' then 6386251
 when '029979036000140' then 6114633
 when '002015588000182' then 6386666
 when '006167121000109' then 6386667
 when '003024308000165' then 6386668
 when '000394460040950' then 6386669
 when '008049061000155' then 6386670
 when '002507452000190' then 6386671
 when '077941490005700' then 6386672
 when '001683902000132' then 6386673
 when '022881858000145' then 6386674
 when '010779434000195' then 6386675
 when '007064763000145' then 6386676
 when '008593703000182' then 6386677
 when '084652296000204' then 6386678
 when '019141190000195' then 6386679
 when '006207284000178' then 6386680
 when '008538000000151' then 6386681
 when '003053023000152' then 6386682
 when '006150972000149' then 6386683
 when '084741354000187' then 6386684
 when '013003038000160' then 6386685
 when '004285920000154' then 6386686
 when '008000933000190' then 6386688
 when '017193501000134' then 6386689
 when '020966588000140' then 6386690
 when '002049227000157' then 6386691
 when '006150481000106' then 6386692
 when '007390665000106' then 6386693
 when '018964366000146' then 6386694
 when '010583792000128' then 6386695
 when '010836966000117' then 6386696
 when '015731191000139' then 6386697
 when '014100867000123' then 6386698
 when '034476176000136' then 6386699
 when '013977860000121' then 6386700
 when '010609637000133' then 6386701
 when '013533398000173' then 6386702
 when '002475985000137' then 6386703
 when '004564530000113' then 6386704
 when '007140303000159' then 6386705
 when '019614838000101' then 6386706
 when '005370912000179' then 6386707
 when '034770156000173' then 6386708
 when '015749688000184' then 6386709
 when '006154053000143' then 6386710
 when '063610679000150' then 6386711
 when '000360305771100' then 6386712
 when '019856906000130' then 6386713
 when '003477309000165' then 6386714
 when '072343882000107' then 6386715
 when '019071378000104' then 6386716
 when '013807868000140' then 6386717
 when '008817403000130' then 6386718
 when '034477133000175' then 6386719
 when '011353669000183' then 6386720
 when '002159675000103' then 6386721
 when '005776670000118' then 6386722
 when '084748656000187' then 6386723
 when '070429956000199' then 6386724
 when '007308881000151' then 6386725
 when '028729142000103' then 6386726
 when '032010011000149' then 6386727
 when '007491532000118' then 6386728
 when '003706607000180' then 6386729
 when '023126035000177' then 6386730
 when '004788116000198' then 6386731
 when '000647694000153' then 6386732
 when '030846316000160' then 6386733
 when '030511964000165' then 6386734
 when '028643008000195' then 6386735
 when '028303312000193' then 6386736
 when '033673687000185' then 6386737
 when '017266480000130' then 6386738
 when '032634648000106' then 6386739
 when '031393217000132' then 6386740
 when '029552649000105' then 6386741
 when '019291865000182' then 6386742
 when '061198164000160' then 6386743
 when '012704512000118' then 6386744
 when '005207997000179' then 6386745
 when '023946190000130' then 6386746
 when '018235272000136' then 6386747
 when '026288524000113' then 6386748
 when '027718661000103' then 6386749
 when '024584199000100' then 6386750
 when '032981941000140' then 6386751
 when '032364822000148' then 6386752
 when '017297963000100' then 6386753
 when '010820186000189' then 6386754
 when '025034906000158' then 6386755
 when '012209450000178' then 6386756
 when '001060256000157' then 6386757
 when '004210418000184' then 6386758
 when '024053940000107' then 6386759
 when '004925681000150' then 6386760
 when '060746948520205' then 6386761
 when '034226139000170' then 6386762
 when '040708647000197' then 6386763
 when '084551191000170' then 6386764
 when '026419311000183' then 6386765
 when '037632662000194' then 6386766
 when '035266554000110' then 6386767
 when '011890033000170' then 6386768
 when '015539260000107' then 6386769
 when '012941509000118' then 6386770
 when '032830059000101' then 6386771
 when '013251866000117' then 6386772
 when '007062650000100' then 6386773
 when '034547148000162' then 6386774
 when '046172470000133' then 6386775
 when '030029272000185' then 6386776
 when '031206587000113' then 6386777
 when '028509817000109' then 6386778
 when '045284493000177' then 6386779
 when '041947390000199' then 6386780
 when '010886827000106' then 6386781
 when '032300342000113' then 6386782
 when '003968287000217' then 6386783
 when '007055892000177' then 6386784
 when '044699753000102' then 6386785
 when '014485146000189' then 6386786
 when '029152522000190' then 6386787
 when '040735739000166' then 6386788
 when '022963049000182' then 6386789
 when '035071309000157' then 6386790
 when '084558808000189' then 6386791
 when '022946181000186' then 6386792
 when '045823623000100' then 6386793
 when '043888799000107' then 6386794
 when '013265121000107' then 6386795
 when '007924894000155' then 6386796
 when '044806174000111' then 6386797
 when '014905502000176' then 6386798
 when '002381253000188' then 6386799
 when '010277241000136' then 6386800
 when '024112329000102' then 6386801
 when '037007414000152' then 6386802
 when '014595725000184' then 6386803
 when '000360305182385' then 6386804
 when '014595896000103' then 6386805
 when '060746948000112' then 6386806
 when '013287059000154' then 6386807
 when '018064217000120' then 6386808
 when '009251627000190' then 6386809
 when '040465664000140' then 6386810
 when '021043390000157' then 6386811
 when '001489352000204' then 6386812
 when '009335360000119' then 6386813
 when '021997155000114' then 6386814
 when '029829129000199' then 6386815
 when '031455241000159' then 6386816
 when '037015599000147' then 6386821
 when '034362391000106' then 6386822
 when '037554194000187' then 6386823
 when '000941837000135' then 6386824
 when '010514043000149' then 6386825
 when '032053182000155' then 6386826
 when '007094705000164' then 6386827
 when '038460625000109' then 6386828
 when '003019611000170' then 6386829
 when '033221055000180' then 6386830
 when '047094428000104' then 6386831
 when '027455068000111' then 6386832
 when '016729422000132' then 6386833
 when '049366231000102' then 6386834
 when '040880276000126' then 6386835
 when '090909631000110' then 6386836
 when '028517413000167' then 6386837
 when '028472036000197' then 6386838
 when '049087832000186' then 6386839
 when '049389689000187' then 6386840
 when '030201398000195' then 6386841
 when '000733062000102' then 6386842
 when '048000136000128' then 6386843
 when '035449896000175' then 6386844
 when '042650279000107' then 6386845
 when '050435426000146' then 6386846
 when '051188104000102' then 6386847
 when '017590221000160' then 6386848
 when '017165203000130' then 6386849
 when '011589175000100' then 6386850
 when '050689798000107' then 6386851
 when '026866060000185' then 6386852
 when '042785781000117' then 6386853
 when '017263792000190' then 6386854
 when '025453131000155' then 6386855
 when '049486433000198' then 6386856
 when '003716848000100' then 6386857
 when '029133837000190' then 6386858
 when '045717515000145' then 6386859
 when '024864422000173' then 6386860
 when '008488130000127' then 6386861
 when '045769285000168' then 6386862
 when '008206867000100' then 6386863
 when '011822931000191' then 6386864
 when '010176098000196' then 6386865
 when '052877454000149' then 6386866
 when '001877007000159' then 6387489
 when '002299035000107' then 6387490
 when '004443856000192' then 6387491
 when '076535764000143' then 6387492
 when '015883796000145' then 6387493
 when '005914650000166' then 6387494
 when '006227270000116' then 6387495
 when '005914254000139' then 6387496
 when '005724290000130' then 6387497
 when '005499167000162' then 6387498
 when '003841631000121' then 6387499
 when '001219621000123' then 6387500
 when '084721711000811' then 6387501
 when '005858487000161' then 6387502
 when '007144639000190' then 6387503
 when '076080738001069' then 6387504
 when '001695608000140' then 6387505
 when '003975619000100' then 6387506
 when '003680854000154' then 6387507
 when '001968300000121' then 6387508
 when '001008073005070' then 6387509
 when '084745363000227' then 6387510
 when '007802078000179' then 6387511
 when '001631144000109' then 6387512
 when '009353904000175' then 6387513
 when '063613129000195' then 6387514
 when '005561956000186' then 6387515
 when '084647163000150' then 6387516
 when '000984753000189' then 6387517
 when '002508642000121' then 6387518
 when '003900778000145' then 6387519
 when '002854777000149' then 6387520
 when '084627892000145' then 6387521
 when '005414375000111' then 6387522
 when '003734841000110' then 6387523
 when '001356570000181' then 6387524
 when '022843049000149' then 6387525
 when '007794537000110' then 6387526
 when '003566347000194' then 6387527
 when '001488049000106' then 6387528
 when '007859148000125' then 6387529
 when '005654140000105' then 6387530
 when '084580547000101' then 6387531
 when '003591477000187' then 6387532
 when '005757430000176' then 6387533
 when '002834982000142' then 6387534
 when '002806380000181' then 6387535
 when '000351475000122' then 6387536
 when '022844641000165' then 6387537
 when '003540778000181' then 6387538
 when '003143270000140' then 6387539
 when '001640326000146' then 6387540
 when '000630035000104' then 6387541
 when '002741990000144' then 6387542
 when '003193135000109' then 6387543
 when '005618620000102' then 6387544
 when '010706062000177' then 6387545
 when '000703157000183' then 6387546
 when '015630311000101' then 6387547
 when '007419512000136' then 6387548
 when '000857256000110' then 6387549
 when '010423607000138' then 6387550
 when '001899908000141' then 6387551
 when '004938024000147' then 6387552
 when '002635451000120' then 6387553
 when '017409892000181' then 6387554
 when '084654326000122' then 6387555
 when '004182628000106' then 6387556
 when '003377433000159' then 6387557
 when '007868496000169' then 6387558
 when '010470734000198' then 6387559
 when '011428253000187' then 6387560
 when '005655626000150' then 6387561
 when '001277775000171' then 6387562
 when '005373398000125' then 6387563
 when '015893134000156' then 6387564
 when '007564443000154' then 6387565
 when '004880425000193' then 6387566
 when '004141713000126' then 6387567
 when '007000882000134' then 6387568
 when '034458240000156' then 6387569
 when '003693136000112' then 6387570
 when '004931721000176' then 6387571
 when '006225530000114' then 6387572
 when '063752604000104' then 6387573
 when '007856593000131' then 6387574
 when '017693214000193' then 6387575
 when '003376298000127' then 6387576
 when '007483226000130' then 6387577
 when '007832547000100' then 6387578
 when '022841969000128' then 6387579
 when '008744589000144' then 6387580
 when '009398565000143' then 6387581
 when '063776124000183' then 6387582
 when '005772561000122' then 6387583
 when '006695690000127' then 6387584
 when '010708879000184' then 6387585
 when '005659781000144' then 6387586
 when '011105453000107' then 6387587
 when '002459850000188' then 6387588
 when '034028316002742' then 6387589
 when '001920903000153' then 6387590
 when '012033715000120' then 6387591
 when '006067041000181' then 6387592
 when '009601702000103' then 6387593
 when '063763296000112' then 6387594
 when '002724634000112' then 6387595
 when '002436234000101' then 6387596
 when '084706423000111' then 6387597
 when '002425969000130' then 6387598
 when '011457999000119' then 6387599
 when '003483599000400' then 6387600
 when '014607859000178' then 6387601
 when '010852238000107' then 6387602
 when '005942282000160' then 6387603
 when '013906632000160' then 6387604
 when '009050368000139' then 6387605
 when '014594006000149' then 6387606
 when '007145658000130' then 6387607
 when '010728958000157' then 6387608
 when '003242329000157' then 6387609
 when '007605578000110' then 6387610
 when '015895055000184' then 6387611
 when '008723763000172' then 6387612
 when '004590168000155' then 6387613
 when '005801565000191' then 6387614
 when '008965958000129' then 6387615
 when '000664815000175' then 6387616
 when '084639640000136' then 6387617
 when '004920948000116' then 6387618
 when '001489352000115' then 6387619
 when '004765259000184' then 6387620
 when '001992449000146' then 6387621
 when '010612219000103' then 6387622
 when '007128204000151' then 6387623
 when '010603772000171' then 6387624
 when '001844555000506' then 6387625
 when '010763711000171' then 6387626
 when '009011815000140' then 6387627
 when '009046958000198' then 6387628
 when '007595449000199' then 6387629
 when '012184921000130' then 6387630
 when '009228728000140' then 6387631
 when '077941490021071' then 6387632
 when '003271268000156' then 6387633
 when '010250636000145' then 6387634
 when '003052878000240' then 6387635
 when '012753429000139' then 6387636
 when '005240325000165' then 6387637
 when '000360305000104' then 6387638
 when '010595527000160' then 6387639
 when '005308885000104' then 6387640
 when '006020318000110' then 6387641
 when '006094629000124' then 6387642
 when '007328533000146' then 6387643
 when '034748137002194' then 6387644
 when '008618301000195' then 6387645
 when '013980662000117' then 6387646
 when '003287956000104' then 6387647
 when '004128765002882' then 6387648
 when '005350754000195' then 6387649
 when '013753133000180' then 6387650
 when '004902581000108' then 6387651
 when '007743188000107' then 6387652
 when '004280889000169' then 6387653
 when '017494458000147' then 6387654
 when '075587915000144' then 6387655
 when '008943701000176' then 6387656
 when '005594098000176' then 6387657
 when '012914243000114' then 6387658
 when '034460378000190' then 6387659
 when '012687517000180' then 6387660
 when '017452553000188' then 6387661
 when '007198442000133' then 6387662
 when '004404295000112' then 6387663
 when '003483599000150' then 6387664
 when '014703354000107' then 6387665
 when '001907433000198' then 6387666
 when '004875322000135' then 6387667
 when '010570899000131' then 6387668
 when '003277610000125' then 6387669
 when '004103250000108' then 6387670
 when '084576784000190' then 6387671
 when '084745363000146' then 6387672
 when '084640176000106' then 6387673
 when '005430141000168' then 6387674
 when '009206268000159' then 6387675
 when '084607241000193' then 6387676
 when '001319536000137' then 6387677
 when '015827025000130' then 6387678
 when '002069724000117' then 6387679
 when '006121648000100' then 6387680
 when '008402759000102' then 6387681
 when '010530917000151' then 6387682
 when '007852024000118' then 6387683
 when '010401465000108' then 6387684
 when '005662126000307' then 6387685
 when '034462218000180' then 6387686
 when '000378257000181' then 6387687
 when '001196537000131' then 6387688
 when '095397113000189' then 6387689
 when '008652912000150' then 6387690
 when '056439789000136' then 6387691
 when '013531759000142' then 6387692
 when '007221727000148' then 6387693
 when '007421674000109' then 6387694
 when '010618757000105' then 6387695
 when '010327123000195' then 6387696
 when '004401743000124' then 6387697
 when '011454373000159' then 6387698
 when '010803506000192' then 6387699
 when '007817352000183' then 6387700
 when '002603612000102' then 6387701
 when '008711577000113' then 6387702
 when '002941892000150' then 6387703
 when '003052955000180' then 6387704
 when '000000000439827' then 6387705
 when '011632642000120' then 6387706
 when '003174759000189' then 6387707
 when '002946823000130' then 6387708
 when '084602382000113' then 6387709
 when '008021336000142' then 6387710
 when '015633531000199' then 6387711
 when '034777714000122' then 6387712
 when '007262508000107' then 6387713
 when '009611953000160' then 6387714
 when '011105389000156' then 6387715
 when '063628937000126' then 6387716
 when '007017545000150' then 6387717
 when '008585011000192' then 6387718
 when '003912940000145' then 6387719
 when '003552842000144' then 6387720
 when '007893566000139' then 6387721
 when '004186962000138' then 6387722
 when '003557406000168' then 6387723
 when '012387366000144' then 6387724
 when '008440584000128' then 6387725
 when '003338544000156' then 6387726
 when '001824931000410' then 6387727
 when '007163502000182' then 6387728
 when '013436844000121' then 6387729
 when '004214987000793' then 6387730
 when '005599564000106' then 6387731
 when '002376914000187' then 6387732
 when '005062571000174' then 6387733
 when '007706235000142' then 6387734
 when '001580103000130' then 6387735
 when '012783204000125' then 6387736
 when '010616400000180' then 6387737
 when '014145218000149' then 6387738
 when '017509651000104' then 6387739
 when '004004410000161' then 6387740
 when '007577306000154' then 6387741
 when '004937272000505' then 6387742
 when '010576469000127' then 6387743
 when '017490080000103' then 6387744
 when '004941555000199' then 6387745
 when '006140580000107' then 6387746
 when '014270606000151' then 6387747
 when '014970304000196' then 6387748
 when '063777718000109' then 6387749
 when '014640070000119' then 6387750
 when '007829461000110' then 6387751
 when '008227391000193' then 6387752
 when '015914608000107' then 6387753
 when '003983300000630' then 6387754
 when '012742772000188' then 6387755
 when '009242214000149' then 6387756
 when '004849366000190' then 6387757
 when '012030349000155' then 6387758
 when '004797536000130' then 6387759
 when '004645599000171' then 6387761
 when '004407029000143' then 6387762
 when '018360533000140' then 6387763
 when '004167190000197' then 6387764
 when '006233460000146' then 6387765
 when '011706139000171' then 6387766
 when '005057151000108' then 6387767
 when '006087679000184' then 6387768
 when '001718567000160' then 6387769
 when '007978004000198' then 6387770
 when '015515617000117' then 6387771
 when '015379145000112' then 6387772
 when '013741623000167' then 6387773
 when '010776550000150' then 6387774
 when '004686790000161' then 6387775
 when '019116410000120' then 6387776
 when '013267908000108' then 6387777
 when '017560176000109' then 6387778
 when '005255167000117' then 6387779
 when '006288306000171' then 6387780
 when '019616657000106' then 6387781
 when '015055087000171' then 6387782
 when '014224773000166' then 6387783
 when '007103838000150' then 6387784
 when '005888433000149' then 6387785
 when '015359395000190' then 6387786
 when '021304235000147' then 6387787
 when '005560438000148' then 6387788
 when '001824931000177' then 6387789
 when '008638886000105' then 6387790
 when '020227207000100' then 6387791
 when '003819835000247' then 6387792
 when '005444097000145' then 6387793
 when '016887646000172' then 6387794
 when '001748911000164' then 6387795
 when '010217367000115' then 6387796
 when '015433890000100' then 6387797
 when '016958226000130' then 6387798
 when '084716059000170' then 6387799
 when '013108368000110' then 6387800
 when '012184877000169' then 6387801
 when '002558157001568' then 6387802
 when '007987315000113' then 6387803
 when '012252418000175' then 6387804
 when '005797417000140' then 6387805
 when '005043720000158' then 6387806
 when '017766803000154' then 6387807
 when '034745729000109' then 6387808
 when '086729324000261' then 6387809
 when '007055987000190' then 6387810
 when '008742289000126' then 6387811
 when '022829881000190' then 6387812
 when '005215132000154' then 6387813
 when '018940390000145' then 6387814
 when '007363874000152' then 6387815
 when '002092051000116' then 6387816
 when '005662126000730' then 6387817
 when '084705573000100' then 6387818
 when '010301300000164' then 6387819
 when '002460701000139' then 6387820
 when '004910717000121' then 6387821
 when '002345383000165' then 6387822
 when '004645704000172' then 6387823
 when '012492961000140' then 6387824
 when '007497935000174' then 6387825
 when '012091985000197' then 6387826
 when '001612452000197' then 6387827
 when '021755115000166' then 6387828
 when '000817788000123' then 6387829
 when '008569259000160' then 6387830
 when '009117368000109' then 6387831
 when '001693372000103' then 6387832
 when '008702152000148' then 6387833
 when '010596399000179' then 6387834
 when '000375972000160' then 6387835
 when '009457677000128' then 6387836
 when '000868882000101' then 6387837
 when '033702309000182' then 6387838
 when '063746556000141' then 6387839
 when '003147401000167' then 6387840
 when '004910717000202' then 6387841
 when '017017798000187' then 6387842
 when '016631876000176' then 6387843
 when '007812826000102' then 6387844
 when '015883838000148' then 6387845
 when '002015588000859' then 6387846
 when '014483359000171' then 6387847
 when '023045893000197' then 6387848
 when '003171199000109' then 6387849
 when '010616400000260' then 6387850
 when '034151100001293' then 6387851
 when '002513526000109' then 6387852
 when '063613269000163' then 6387853
 when '020063556000134' then 6387854
 when '018876112000176' then 6387855
 when '023186088000183' then 6387856
 when '012406354000110' then 6387857
 when '012934489000158' then 6387858
 when '022852124000138' then 6387859
 when '019687659000196' then 6387860
 when '021132190000170' then 6387861
 when '004730292000179' then 6387862
 when '004996600000102' then 6387863
 when '004901195000363' then 6387864
 when '000396895000125' then 6387865
 when '004128765000162' then 6387866
 when '006926016000106' then 6387867
 when '019406885000151' then 6387868
 when '003983300000550' then 6387869
 when '010464540000180' then 6387870
 when '022003386000128' then 6387871
 when '008457879000107' then 6387872
 when '010939002000102' then 6387873
 when '067729178000149' then 6387874
 when '005599253000147' then 6387875
 when '007074869000120' then 6387876
 when '018571247000123' then 6387877
 when '022246173000127' then 6387878
 when '009219184000150' then 6387879
 when '005700510000195' then 6387880
 when '017669661000107' then 6387881
 when '002176223000482' then 6387882
 when '027358419000176' then 6387883
 when '003363727000121' then 6387884
 when '009117354000195' then 6387885
 when '016806894000141' then 6387886
 when '093577427000138' then 6387887
 when '006628333000146' then 6387888
 when '001429437000108' then 6387889
 when '021324430000139' then 6387890
 when '018882641000182' then 6387891
 when '022045606000186' then 6387892
 when '026461729000159' then 6387893
 when '021227039000116' then 6387894
 when '008715446000104' then 6387895
 when '005222638000190' then 6387896
 when '067729178000491' then 6387897
 when '018666293000106' then 6387898
 when '014173803000152' then 6387899
 when '006209557000113' then 6387900
 when '004280889000401' then 6387901
 when '015439366000139' then 6387902
 when '023312871000146' then 6387903
 when '018386337000144' then 6387904
 when '014665070000173' then 6387905
 when '005559588000131' then 6387906
 when '003859153000187' then 6387907
 when '002961362000174' then 6387908
 when '027125873000187' then 6387909
 when '014594006000300' then 6387910
 when '024961074000152' then 6387911
 when '001999130000142' then 6387912
 when '021297758000103' then 6387913
 when '022397093000172' then 6387914
 when '019907343000162' then 6387915
 when '012632841000109' then 6387916
 when '042799163000126' then 6387917
 when '005411552000106' then 6387918
 when '014272952000179' then 6387919
 when '017472278000164' then 6387920
 when '028268918000135' then 6387921
 when '010749915000158' then 6387922
 when '012278579000138' then 6387923
 when '006065614000138' then 6387924
 when '027580655000132' then 6387927
 when '001698481000113' then 6387928
 when '091824383000178' then 6387929
 when '004735755000195' then 6387930
 when '030035691000120' then 6387931
 when '024011990000121' then 6387932
 when '017221558000108' then 6387933
 when '017353208000197' then 6387934
 when '021432974000114' then 6387935
 when '022870240000180' then 6387936
 when '059104760000191' then 6387937
 when '001942594000112' then 6387938
 when '072333060000137' then 6387939
 when '009596932000113' then 6387940
 when '016845253000104' then 6387941
 when '003968287000136' then 6387942
 when '005099538000380' then 6387943
 when '009433892000199' then 6387944
 when '002221741000209' then 6387945
 when '007308989000144' then 6387946
 when '016970999000131' then 6387947
 when '010493969000103' then 6387948
 when '005440065000171' then 6387949
 when '023955392000148' then 6387950
 when '032643085000112' then 6387951
 when '030202074000171' then 6387952
 when '026246234000107' then 6387953
 when '032785799000165' then 6387954
 when '001936577000172' then 6387955
 when '039472306000186' then 6387956
 when '033114868000171' then 6387957
 when '036074436000172' then 6387958
 when '034439967000196' then 6387959
 when '024252748000140' then 6387960
 when '008027382000159' then 6387961
 when '005287117000111' then 6387962
 when '028493685000174' then 6387963
 when '027457005000102' then 6387964
 when '031507468000109' then 6387965
 when '004196645000100' then 6387966
 when '027262269000100' then 6387967
 when '009381459000157' then 6387968
 when '036656877000182' then 6387969
 when '028737608000112' then 6387970
 when '013160566000122' then 6387971
 when '000662270000320' then 6387972
 when '026898124000120' then 6387973
 when '016557958000118' then 6387974
 when '053276010000110' then 6387975
 when '011903434000118' then 6387976
 when '030011713000111' then 6387977
 when '026873958000180' then 6387978
 when '023090845000110' then 6387979
 when '037685557000113' then 6387980
 when '006354628000171' then 6387981
 when '005555440000129' then 6387982
 when '004930590000102' then 6387983
 when '008571023000168' then 6387984
 when '034771667000100' then 6387985
 when '019180210000137' then 6387986
 when '011994158000140' then 6387987
 when '035963155000370' then 6387988
 when '028325407000108' then 6387989
 when '036181473000180' then 6387990
 when '008270247000130' then 6387991
 when '063766604000163' then 6387992
 when '026228229000171' then 6387993
 when '003319740000183' then 6387994
 when '048497100000100' then 6387995
 when '008335312000168' then 6387996
 when '078800190000119' then 6387997
 when '012939753000146' then 6387998
 when '043640754000119' then 6387999
 when '007880019000119' then 6388000
 when '003555829000149' then 6388001
 when '009317468000189' then 6388002
 when '005700276000104' then 6388003
 when '003061540000173' then 6388004
 when '003353358000196' then 6388005
 when '002845096000114' then 6388006
 when '003406841000191' then 6388007
 when '005561915000190' then 6388008
 when '003261925000184' then 6388009
 when '063772925000170' then 6388010
 when '004798328000156' then 6388011
 when '006198597000107' then 6388012
 when '016951665000110' then 6388013
 when '033948013000146' then 6388014
 when '004776829000131' then 6388015
 when '009434557000105' then 6388016
 when '035519023000191' then 6388017
 when '032841683000104' then 6388018
 when '041146144000138' then 6388019
 when '031108146000189' then 6388020
 when '037322059000106' then 6388021
 when '003119645000136' then 6388022
 when '046756549000101' then 6388023
 when '022548304000120' then 6388024
 when '001911821000142' then 6388025
 when '029400170000145' then 6388026
 when '007164212000153' then 6388027
 when '005220344000120' then 6388028
 when '009423379000117' then 6388029
 when '023943994000185' then 6388030
 when '076535764032347' then 6388031
 when '001718571000129' then 6388032
 when '011085816000181' then 6388033
 when '005590889000128' then 6388034
 when '005240351000193' then 6388035
 when '004240107000168' then 6388036
 when '063760169000160' then 6388037
 when '006158734000180' then 6388038
 when '008678888000128' then 6388039
 when '005692468000108' then 6388040
 when '001625962000107' then 6388041
 when '005734898000145' then 6388042
 when '029949914000185' then 6388043
 when '004346736000177' then 6388044
 when '002459848000109' then 6388045
 when '004840040000100' then 6388046
 when '002176223000130' then 6388047
 when '005376019000150' then 6388048
 when '004281381000185' then 6388049
 when '007824532000192' then 6388050
 when '007547567000121' then 6388051
 when '002578778000108' then 6388052
 when '004790881000142' then 6388053
 when '000849450000153' then 6388054
 when '000995371000150' then 6388055
 when '010760678000126' then 6388056
 when '004824279000189' then 6388057
 when '007549414000113' then 6388058
 when '005320802000100' then 6388059
 when '002988602000124' then 6388060
 when '009125308000138' then 6388061
 when '000664769000104' then 6388062
 when '034766592000179' then 6388063
 when '007672177000183' then 6388064
 when '012369730000143' then 6388065
 when '008107158000177' then 6388066
 when '012282693000131' then 6388067
 when '004429478000273' then 6388068
 when '011568489000119' then 6388069
 when '007518435000171' then 6388070
 when '004233946000159' then 6388071
 when '004560736000175' then 6388072
 when '011260203000133' then 6388073
 when '003652030000170' then 6388074
 when '013843059000193' then 6388075
 when '015882962000199' then 6388076
 when '013140485000160' then 6388077
 when '005593405000102' then 6388078
 when '011567074000473' then 6388079
 when '013994224000108' then 6388080
 when '002520829000140' then 6388081
 when '002176223000210' then 6388082
 when '006696359000121' then 6388083
 when '005928290000151' then 6388084
 when '003193160000192' then 6388085
 when '034765313000152' then 6388086
 when '010539000000118' then 6388087
 when '026989350000116' then 6388088
 when '011376952000120' then 6388089
 when '002132032000176' then 6388090
 when '033484825000188' then 6388091
 when '018449504000906' then 6388092
 when '003819835000409' then 6388093
 when '005612413000140' then 6388094
 when '021630814000180' then 6388095
 when '009188441000133' then 6388096
 when '012889035000102' then 6388097
 when '006935554000167' then 6388098
 when '016917181000155' then 6388099
 when '005887870000148' then 6388100
 when '007179654000173' then 6388101
 when '017191704000191' then 6388102
 when '013383651000150' then 6388103
 when '004301884000175' then 6388104
 when '006911404000113' then 6388105
 when '007805458000167' then 6388106
 when '015861263000162' then 6388107
 when '015332890000106' then 6388108
 when '084652296000115' then 6388109
 when '010516924000107' then 6388110
 when '019597091000112' then 6388111
 when '005567724000135' then 6388112
 when '011950190000124' then 6388113
 when '000789321000117' then 6388114
 when '016709275000139' then 6388115
 when '022516950000106' then 6388116
 when '018745490000110' then 6388117
 when '005286960000183' then 6388118
 when '006290630000124' then 6388119
 when '006151921001456' then 6388120
 when '012034121000133' then 6388121
 when '077410249000604' then 6388122
 when '001526219000191' then 6388123
 when '022862531000126' then 6388124
 when '005686530000159' then 6388125
 when '020483193000196' then 6388126
 when '018064217000392' then 6388127
 when '023871309000152' then 6388128
 when '010942831000136' then 6388129
 when '004214231000159' then 6388130
 when '022645916000131' then 6388131
 when '000530493000171' then 6388132
 when '003843541000170' then 6388133
 when '008676370000155' then 6388134
 when '004287520000188' then 6388135
 when '008593528000123' then 6388136
 when '015723680000149' then 6388137
 when '021262327000101' then 6388138
 when '006977683000118' then 6388139
 when '008835955000170' then 6388140
 when '013878114000180' then 6388141
 when '009053748000127' then 6388142
 when '034649306000195' then 6388143
 when '029234599000100' then 6388144
 when '032933627000191' then 6388145
 when '002572720000157' then 6388146
 when '046010972000168' then 6388147
 when '020721022000158' then 6388148
 when '048373392000160' then 6388149
 when '032468738000174' then 6388150
 when '049073383000117' then 6388151
 when '045075197000166' then 6388152
 when '010809350000238' then 6388153
 when '038169209000156' then 6388154
 when '030860667000125' then 6388155
 when '017737428000114' then 6388156
 when '015415734000109' then 6388157
 when '049549804000133' then 6388158
 when '008106716000180' then 6388159
 when '020513866000103' then 6388160
 when '025383889000164' then 6388161
 when '046218314000166' then 6388162
 when '007626776000160' then 6388163
 when '047424115000177' then 6388164
 when '030268590000107' then 6388165
 when '009338447000140' then 6388166
 when '018394492000102' then 6388167
 when '002337949000107' then 6388168
 when '003983300000126' then 6388169
 when '018775214000103' then 6388170
 when '006537231000115' then 6388171
 when '032067646000182' then 6388172
 when '002031452000166' then 6388173
 when '027241381000157' then 6388174
 when '005985291000138' then 6388175
 when '002421421002327' then 6388176
 when '038306886000179' then 6388177
 when '029004099000181' then 6388178
 when '007824144000101' then 6388179
 when '007473831000120' then 6388180
 when '004206050000180' then 6388181
 when '084582592000197' then 6388182
 when '007677098000165' then 6388183
 when '084752302000106' then 6388184
 when '010564064000179' then 6388185
 when '003047782000102' then 6388186
 when '077941490000155' then 6388187
 when '063771588000105' then 6388188
 when '084579242000171' then 6388189
 when '002834982000223' then 6388190
 when '000857242000104' then 6388191
 when '042036849000165' then 6388192
 when '002703017000130' then 6388193
 when '034028316467206' then 6388194
 when '001022749000100' then 6388195
 when '084553767000138' then 6388196
 when '003970510000180' then 6388197
 when '002558124000112' then 6388198
 when '004656007000117' then 6388199
 when '008580600000188' then 6388200
 when '008303100000107' then 6388201
 when '004965734000166' then 6388202
 when '007862772000181' then 6388203
 when '009601974000103' then 6388204
 when '069942019000153' then 6388205
 when '013504249000186' then 6388206
 when '026427897000128' then 6388207
 when '009148181000172' then 6388208
 when '015438125000175' then 6388209
 when '042422253000101' then 6388210
 when '011517268000111' then 6388211
 when '007134028000160' then 6388213
 when '008828770000139' then 6388214
 when '022833891000108' then 6388215
 when '008830521000188' then 6388216
 when '002521092000180' then 6388217
 when '020265417000193' then 6388218
 when '015875594000151' then 6388219
 when '008174901000101' then 6388220
 when '005968867000159' then 6388221
 when '010607248000179' then 6388222
 when '007575651000159' then 6388223
 when '003861701006063' then 6388224
 when '014537373000100' then 6388225
 when '009196409000108' then 6388226
 when '012637697000195' then 6388227
 when '022140726000162' then 6388228
 when '006094644000172' then 6388229
 when '002049091000185' then 6388230
 when '007868076000182' then 6388231
 when '019121290000150' then 6388232
 when '063764211000110' then 6388233
 when '007175208000190' then 6388234
 when '013236729000103' then 6388235
 when '017337556000170' then 6388236
 when '084553452000190' then 6388237
 when '009543704000185' then 6388238
 when '007843902000139' then 6388239
 when '012978319000175' then 6388240
 when '011587975000184' then 6388241
 when '010193679000136' then 6388242
 when '011595232000156' then 6388243
 when '005829910000103' then 6388244
 when '008668936000105' then 6388245
 when '007911855000113' then 6388246
 when '021936310000192' then 6388247
 when '023969376000104' then 6388248
 when '011649832000150' then 6388249
 when '014289396000143' then 6388250
 when '021894569000118' then 6388251
 when '063616890000180' then 6388252
 when '000394460005887' then 6388253
 when '014031732000153' then 6388254
 when '027104079000157' then 6388255
 when '003687065000145' then 6388256
 when '000087112000121' then 6388257
 when '022217472000133' then 6388258
 when '024132138000102' then 6388259
 when '006916360000114' then 6388260
 when '020274372000113' then 6388261
 when '007177807000143' then 6388262
 when '008889320000237' then 6388263
 when '004804931000101' then 6388264
 when '063746101000126' then 6388265
 when '034748137002003' then 6388266
 when '004637690000145' then 6388267
 when '008397376000193' then 6388268
 when '030879025000178' then 6388269
 when '010890855000199' then 6388270
 when '004771481000513' then 6388271
 when '084752914000107' then 6388272
 when '015895055000346' then 6388273
 when '010809350000157' then 6388274
 when '010633008000149' then 6388275
 when '009590425000172' then 6388276
 when '022969619000141' then 6388277
 when '004012436002103' then 6388278
 when '027072960000113' then 6388279
 when '032681123000121' then 6388280
 when '008853304000103' then 6388281
 when '028407129000138' then 6388282
 when '040432544000147' then 6388283
 when '013719523000134' then 6388284
 when '018662147000102' then 6388285
 when '022859383000190' then 6388286
 when '004940647000154' then 6388287
 when '084553742000134' then 6388288
 when '038223438000101' then 6388289
 when '023700414000129' then 6388290
 when '040195921000171' then 6388291
 when '004689410000142' then 6388292
 when '014597850000123' then 6388293
 when '004012436000402' then 6388294
 when '017729832000146' then 6388295
 when '040310949000102' then 6388296
 when '003357895000104' then 6388297
 when '008945027000169' then 6388298
 when '075587915016229' then 6388299
 when '021818011000153' then 6388300
 when '012688058000159' then 6388301
 when '006990152000165' then 6388302
 when '005880596000185' then 6388303
 when '026831638000168' then 6388304
 when '004794996000709' then 6388305
 when '020129563000191' then 6388306
 when '083594978000156' then 6388307
 when '026249415000197' then 6388308
 when '024209540000148' then 6388309
 when '004471458000180' then 6388310
 when '023100310000183' then 6388311
 when '022057891000155' then 6388312
 when '004012436002871' then 6388313
 when '026888646000140' then 6388314
 when '006151921001375' then 6388315
 when '036864659000133' then 6388316
 when '026119152000100' then 6388317
 when '022755309000124' then 6388318
 when '018336780000100' then 6388319
 when '004632378000169' then 6388320
 when '019646672000105' then 6388321
 when '011773245000178' then 6388322
 when '000838558000140' then 6388323
 when '029920016000102' then 6388324
 when '004609906000169' then 6388325
 when '077941490033592' then 6388326
 when '018162212000130' then 6388327
 when '022739420000127' then 6388328
 when '007733374000165' then 6388329
 when '037652289000133' then 6388330
 when '018409608000130' then 6388331
 when '043956646000150' then 6388332
 when '013782282000178' then 6388333
 when '003604410000130' then 6388334
 when '048292041000125' then 6388335
 when '004602452000102' then 6388336
 when '012406354000209' then 6388337
 when '033754073000128' then 6388338
 when '024448443000108' then 6388339
 when '040690097000126' then 6388340
 when '027976111000194' then 6388341
 when '002642034000105' then 6388342
 when '047615394000156' then 6388343
 when '007490167000127' then 6388344
 when '050213403000197' then 6388345
 when '014939270012000' then 6388346
 when '035231746000190' then 6388347
 when '046093723000183' then 6388348
 when '048463797000190' then 6388349
 when '049975935000182' then 6388350
 when '012560276000103' then 6388351
 when '021679098000125' then 6388352
 when '009363297000124' then 6388353
 when '004352905000181' then 6388354
 when '027680488000100' then 6388355
 when '043195850000103' then 6388356
 when '029056741000176' then 6388357
 when '026628908000138' then 6388358
 when '047210587000127' then 6388359
 when '028706488000196' then 6388360
 when '028877319000119' then 6388361
 when '027467771000140' then 6388362
 when '040788617000138' then 6388363
 when '043423571000141' then 6388364
 when '028439635000109' then 6388365
 when '000394585001062' then 6388366
 when '031304354000153' then 6388367
 when '065149197000251' then 6388368
 when '009560267000108' then 6388369
 when '011041570000146' then 6388370
 when '021544717000174' then 6388371
 when '007781779000179' then 6388372
 when '042438504000138' then 6388373
 when '004879902000109' then 6388374
 when '029736277000169' then 6388375
 when '020371330000109' then 6388376
 when '040770716000192' then 6388377
 when '037621806000107' then 6388378
 when '040192091000129' then 6388379
 when '034359923000156' then 6388380
 when '31393217000132' then 6386740

end as id
FOR JSON PATH, WITHOUT_ARRAY_WRAPPER)
) AS credor,
CONCAT('DESPESA EXTRAORÇAMENTARIA DA MIGRAÇÃO: ', rec.DS_RECEITA)  AS especificacao,
        ct.cd_empenho  as numeroCadastro,
                JSON_QUERY(
                            (SELECT
								                JSON_QUERY(
                            (SELECT
                                case         rec.DS_RECEITA
                                when 'CONSIGANDO SICOOB CREDIP - PMP' then 66434
when 'CONSIGNADO BANCO BRADESCO - PMP' then 66435
when 'CONSIGNADO BANCO CAIXA ECONÔMICA FEDERAL - PMP' then 66436
when 'DESCONTO COMPRA SINSEZMAT - PMP' then 66437
when 'CONTRIBUIÇÃO MENSAL SINSEZMAT - PMP' then 66438
when 'CONTRIBUIÇÃO MENSAL SINTERO - PMP' then 66439
when 'IMPOSTO DE RENDA RETIDO NA FONTE - PMP' then 66440
when 'INSS EMPREGADO - PMP' then 66441
when 'PENSÃO JUDICIAL ALIMENTÍCIA - PMP' then 66442
when 'RETENÇÃO JUDICIAL RETIDO DE SERVIDOR - PMP' then 66443
when 'RETENÇÃO - IRPJ' then 66444
when 'RETENÇÃO - IRPF' then 66445
when 'CAMARA MUNICIPAL' then 16536
when 'DESPESAS FUNDO MUNICIPAL DE SAUDE' then 16537
when 'FUNDO MUN. DE ASSISTENCIA SOCIAL'  then 16538
								  end as id,
                               'RETENCAO_EXTRA' AS tipo
                                    FOR JSON PATH, WITHOUT_ARRAY_WRAPPER)
                            ) AS classificacao,
                                ct.vl_empenho AS valor,
JSON_QUERY(
(SELECT
								JSON_QUERY(
                            (SELECT
                            case ct.cd_DestinacaoRecurso
when        150000000000        then        744141
when        150000150000        then        744143
when        150000250000        then        744145
when        160000000000        then        744203
when        166100000000        then        744235
when        154000000000        then        744155
when        154000700000        then        744159
when        155000000000        then        744177
when        170000000000        then        744243
when        170100000000        then        744245
when        257100000000        then        744401
when        270000000000        then        744455
when        270100000000        then        744457
                            end as id
                        FOR JSON PATH, WITHOUT_ARRAY_WRAPPER)
                    ) AS recurso,
                               ct.vl_empenho AS valor
							   FOR JSON PATH, WITHOUT_ARRAY_WRAPPER)
							   ) AS recursos
                                    FOR JSON PATH, WITHOUT_ARRAY_WRAPPER)
                            ) AS classificacoes,
                            'FOLHA' as identificador,
JSON_QUERY(
                            (SELECT
JSON_QUERY(
(SELECT          
                    m.dt_movto AS data, 
					 JSON_QUERY(
(SELECT

25442 AS id
  FOR JSON PATH, WITHOUT_ARRAY_WRAPPER)
                    ) AS transacaoFinanceira,
					   m.cd_codigo  as numeroCadastro,
					   					 JSON_QUERY(
(SELECT

                        case  b.cd_codconta
 when 8642 then 185314
 when 8643 then 185315
 when 20831 then 185316
 when 12197 then 185317
 when 60028 then 185318
 when 13100 then 185319
 when 60049 then 185320
 when 60047 then 185321
 when 60015 then 185322
 when 11737 then 185323
 when 60048 then 185324
 when 13452 then 185325
 when 13513 then 185326
 when 283144 then 185327
 when 8645 then 185328
 when 13328 then 185329
 when 13548 then 185330
 when 13512 then 185331
 when 15051 then 185332
 when 60040 then 185333
 when 60024 then 185334
 when 13362 then 185335
 when 00671060 then 185336
 when 13552 then 185337
 when 6000312 then 185338
 when 13543 then 185339
 when 13544 then 185340
 when 13547 then 185341
 when 12018 then 185342
 when 6000313 then 185343
 when 43488 then 185344
 when 43490 then 185345
 when 43491 then 185346
 when 43489 then 185347
 when 13632 then 185348
 when 13542 then 185349
 when 60027 then 185350
 when 60023 then 185351
 when 13113 then 185352
 when 60022 then 185353
 when 60036 then 185354
 when 13676 then 185355
 when 60037 then 185356
 when 13048 then 185357
 when 60042 then 185358
 when 6071008 then 185359
 when 46534 then 185360
 when 7889 then 185361
 when 8030 then 185362
 when 60039 then 185363
 when 13689 then 185364
 when 8101 then 185365
 when 13103 then 185366
 when 14101 then 185367
 when 7909 then 185368
 when 13538 then 185369
 when 7945 then 185370
 when 13540 then 185371
 when 13541 then 185372
 when 14253 then 185373
 when 13327 then 185374
 when 00600071063 then 185375
 when 006647240 then 185376
 when 14370 then 185377
 when 14385 then 185378
 when 006071095 then 185379
 when 14440 then 185380
 when 14479 then 185381
 when 14369 then 185382
 when 14399 then 185383
 when 14398 then 185384
 when 14397 then 185385
 when 14685 then 185386
 when 14688 then 185387
 when 14689 then 185388
 when 14694 then 185389
 when 14708 then 185390
 when 14690 then 185391
 when 14693 then 185392
 when 14691 then 185393
 when 9208 then 185394
 when 14687 then 185395
 when 14715 then 185396
 when 14711 then 185397
 when 13577 then 185398
 when 14920 then 185399
 when 14919 then 185400
 when 131099 then 185401
 when 14478 then 185402
 when 14951 then 185403
 when 672007 then 185404
 when 14935 then 185405
 when 14974 then 185406
 when 9896 then 185407
 when 15199 then 185408
 when 15271 then 185409
 when 15353 then 185410
 when 9310 then 185411
 when 15409 then 185412
 when 15249 then 185413
 when 15332 then 185414
 when 15277 then 185415
 when 006647256 then 185416
 when 006647252 then 185417
 when 10162 then 185418
 when 10163 then 185419
 when 10164 then 185420
 when 006647253 then 185421
 when 006647258 then 185422
 when 15369 then 185423
 when 15490 then 185424
 when 10219 then 185425
 when 11058 then 185426
 when 11525 then 185427
 when 18223 then 185428
 when 11383 then 185429
 when 11542 then 185430
 when 12252 then 185431
 when 12177 then 185432
 when 03013 then 185433
 when 03014 then 185434
 when 60006 then 185435
 when 60001 then 185436
 when 60002 then 185437
 when 60003 then 185438
 when 60004 then 185439
 when 13647 then 185440
 when 60005 then 185441
 when 6624088 then 185442
 when 6000315 then 185443
 when 13015 then 185444
 when 13021 then 185445
 when 44010 then 185446
 when 14365 then 185447
 when 14480 then 185448
 when 14536 then 185449
 when 14487 then 185450
 when 14686 then 185451
 when 15209 then 185452
 when 15264 then 185453
 when 15380 then 185454
 when 15422 then 185455
 when 15350 then 185456
 when 9881 then 185457
 when 11500 then 185458
 when 11623 then 185459
 when 43997 then 185460
 when 12324 then 185507
 when 12328 then 185508
 when 13632 then 185509
 when 12326 then 185510
 when 14206 then 185511
 when 14310 then 185512
 when 14741 then 185513
 when 13576 then 185514
 when 14463 then 185515
 when 60018 then 185516
 when 44001 then 185517
 when 60041 then 185518
 when 60045 then 185519
 when 60044 then 185520
 when 12903 then 185521
 when 84506 then 185522
 when 87165 then 185523
 when 13563 then 185524
 when 13564 then 185525
 when 13641 then 185526
 when 15080 then 185527
 when 15161 then 185528
 when 15435 then 185529
 when 43997 then 185530
                         end as id
  FOR JSON PATH, WITHOUT_ARRAY_WRAPPER)
                    ) AS contaBancariaEntidade,

                    JSON_QUERY(
                            (SELECT
                            case ct.cd_DestinacaoRecurso
when        150000000000        then        744141
when        150000150000        then        744143
when        150000250000        then        744145
when        160000000000        then        744203
when        166100000000        then        744235
when        154000000000        then        744155
when        154000700000        then        744159
when        155000000000        then        744177
when        170000000000        then        744243
when        170100000000        then        744245
when        257100000000        then        744401
when        270000000000        then        744455
when        270100000000        then        744457
                            end as id
                        FOR JSON PATH, WITHOUT_ARRAY_WRAPPER)
                    ) AS recurso,
					ct.vl_empenho AS valor
					                        FOR JSON PATH, WITHOUT_ARRAY_WRAPPER)
                    ) AS recursos
                        FOR JSON PATH, WITHOUT_ARRAY_WRAPPER)
                    ) AS baixa
FOR JSON PATH, WITHOUT_ARRAY_WRAPPER)
) AS content        
from CONTEMPENHOS as ct
inner join CONTFORNECEDORES as a 
on ct.cd_fornecedor = a.cd_fornecedor
inner join CONTFICHARECEITA as rec
on ct.cd_cecam = rec.cd_cecam and ct.cd_fichadesp = rec.cd_ficharec
inner join CONT_MOVIMENTACAO m
on ct.cd_pagamento = m.cd_codigo_inicial and ct.cd_cecam = m.cd_cecam
inner join CONTFICHABANCOS  b
on m.cd_banco = b.cd_banco 
and m.cd_cecam = b.cd_cecam
WHERE ct.cd_cecam = 1995
and ct.cd_fichadesp  like '53%' or  ct.cd_fichadesp  like '581%'
and ct.vl_empenho > 0
and ct.cd_empenhob = 1
        `;

        const result = await masterConnection.query(userQuery);
        const resultData = result.recordset;

        // Transformar os resultados da consulta no formato desejado
        const transformedData = resultData.map(record => {
            // Parse o conteúdo JSON retornado do SELECT
            const content = JSON.parse(record.content);
        
            return {
                idIntegracao: record.idIntegracao ? record.idIntegracao.toString() : "INTEGRACAO1", // Convertendo idIntegracao para string
                content: {
                    exercicio: content.exercicio, // Usando o valor do SELECT
                    data: formatDate(content.data), // Formatando a data no formato AAAA-MM-DD
                    dataVencimento: formatDate(content.dataVencimento), // Formatando a data de vencimento
                    credor: {
                        id: content.credor.id // Usando o id do credor
                    },
                    especificacao: content.especificacao, // Usando o valor retornado para especificação
                    numeroCadastro: content.numeroCadastro, // Usando o número de cadastro
                    classificacoes: [
                        {
                            classificacao: {
                                id: content.classificacoes.classificacao.id, // Usando o id da classificação
                                tipo: content.classificacoes.classificacao.tipo // Usando o tipo da classificação
                            },
                            valor: content.classificacoes.valor, // Usando o valor da classificação
                            recursos: [
                                {
                                    recurso: {
                                        id: content.classificacoes.recursos.recurso.id // Usando o id do recurso
                                    },
                                    valor: content.classificacoes.recursos.valor // Usando o valor do recurso
                                }
                            ],
                            identificador: content.identificador // Usando o identificador
                        }
                    ],
                    baixa: {
                        data: formatDate(content.baixa.recursos.data), // Formatando a data da baixa
                        transacaoFinanceira: {
                            id: content.baixa.recursos.transacaoFinanceira.id // Usando o id da transação financeira
                        },
                        numeroDocumento: content.baixa.recursos.numeroCadastro.toString(), // Usando o número de documento
                        contaBancariaEntidade: {
                            id: content.baixa.recursos.contaBancariaEntidade.id // Usando o id da conta bancária da entidade
                        },
                        recursos: [
                            {
                                recurso: {
                                    id: content.baixa.recursos.recurso.id // Usando o id do recurso da baixa
                                },
                                valor: content.baixa.recursos.valor // Usando o valor do recurso da baixa
                            }
                        ]
                    }
                }
            };
        }).filter(record => record !== null); // Filtrando registros nulos
        
        
        
        



        const chunkSize = 50;
        for (let i = 0; i < transformedData.length; i += chunkSize) {
            const chunk = transformedData.slice(i, i + chunkSize);
            const chunkFileName = `log_envio_${i / chunkSize + 1}.json`;
            fs.writeFileSync(chunkFileName, JSON.stringify(chunk, null, 2));
            console.log(`Dados salvos em ${chunkFileName}`);
        }

        // Enviar cada registro individualmente para a rota desejada
        /* for (const record of transformedData) {
            const response = await fetch('https://con-sl-rest.betha.cloud/contabil/service-layer/v2/api/despesas-extras', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': 'Bearer 1d12dec7-0720-4b34-a2e5-649610d10806'
                },
                body: JSON.stringify(record)
            });

            if (response.ok) {
                console.log(`Dados do registro enviados com sucesso para a rota.`);
            } else {
                console.error(`Erro ao enviar os dados do registro para a rota:`, response.statusText);
            }
        } */

    } catch (error) {
        console.error('Erro durante a execução do programa:', error);
    } finally {
        // Fechar a conexão com o SQL Server
        sql.close();
    }
}

main();
