const sql = require('mssql');
const dotenv = require('dotenv');
const fetch = require('node-fetch');
const fs = require('fs');

dotenv.config();

async function connectToSqlServer() {
    try {
        const server = process.env.SERVER;
        const database = process.env.DATABASE;
        const username = process.env.USERNAME_SQLSERVER;
        const password = process.env.PASSWORD;

        const config = {
            user: username,
            password: password,
            server: server,
            database: database,
            options: {
                encrypt: false
            }
        };

        const pool = await sql.connect(config);
        console.log("Conectado ao SQL Server");
        return pool;
    } catch (error) {
        console.error('Erro ao conectar ao SQL Server:', error);
        throw error;
    }
}

async function logResponse(id, responseText) {
    const logMessage = `ID: ${id}\nResposta: ${responseText}\n\n`;
    fs.appendFileSync('delete_log.txt', logMessage, (err) => {
        if (err) {
            console.error('Erro ao gravar no log:', err);
        }
    });
}

async function main() {
    const idsParaExcluir = [
       
        20595213,
        20595214,
        20595215,
        20595216,
        20595217,
        20595218,
        20595219,
        20595220,
        20595221,
        20595222,
        20595223,
        20595224,
        20595225,
        20595226,
        20595227,
        20595229,
        20595230,
        20595231,
        20595232,
        20595233,
        20595234,
        20595235,
        20595236,
        20595237,
        20595238,
        20595239,
        20595240,
        20595241,
        20595242,
        20595243,
        20595244,
        20595245,
        20595246,
        20595248,
        20595249,
        20595250,
        20595251,
        20595252,
        20595253,
        20595254,
        20595255,
        20595256,
        20595257,
        20595258,
        20595259,
        20595260,
        20595261,
        20595262,
        20595263,
        20595264,
        20595265,
        20595266,
        20595267,
        20595268,
        20595269,
        20595270,
        20595271,
        20595272,
        20595273,
        20595274,
        20595275,
        20595276,
        20595277,
        20595279,
        20595280,
        20595281,
        20595282,
        20595283,
        20595284,
        20595285,
        20595286,
        20595287,
        20595288,
        20595289,
        20595290,
        20595291,
        20595292,
        20595293,
        20595294,
        20595295,
        20595296,
        20595297,
        20595298,
        20595299,
        20595300,
        20595301,
        20595302,
        20595303,
        20595304,
        20595305,
        20595306,
        20595307,
        20595308,
        20595309,
        20595310,
        20595311,
        20595312,
        20595313,
        20595314,
        20595315,
        20595316,
        20595317,
        20595318,
        20595319,
        20595320,
        20595321,
        20595322,
        20595323,
        20595324,
        20595325,
        20595326,
        20595327,
        20595328,
        20595329,
        20595330,
        20595331,
        20595332,
        20595333,
        20595334,
        20595335,
        20595336,
        20595337,
        20595338,
        20595339,
        20595340,
        20595341,
        20595342,
        20595343,
        20595344,
        20595345,
        20595346,
        20595347,
        20595348,
        20595349,
        20595350,
        20595351,
        20595352,
        20595353,
        20595354,
        20595355,
        20595356,
        20595357,
        20595358,
        20595359,
        20595360,
        20595361,
        20595362,
        20595363,
        20595364,
        20595365,
        20595366,
        20595367,
        20595368,
        20595369,
        20595370,
        20595371,
        20595372,
        20595373,
        20595374,
        20595375,
        20595376,
        20595377,
        20595378,
        20595379,
        20595380,
        20595381,
        20595382,
        20595383,
        20595384,
        20595385,
        20595386,
        20595387,
        20595388,
        20595389,
        20595390,
        20595391,
        20595392,
        20595393,
        20595394,
        20595395,
        20595396,
        20595397,
        20595398,
        20595399,
        20595400,
        20595401,
        20595402,
        20595403,
        20595404,
        20595405,
        20595406,
        20595407,
        20595408,
        20595410,
        20595411,
        20595412,
        20595413,
        20595414,
        20595415,
        20595416,
        20595417,
        20595418,
        20595419,
        20595420,
        20595421,
        20595422,
        20595423,
        20595424,
        20595425,
        20595426,
        20595427,
        20595428,
        20595429,
        20595430,
        20595431,
        20595432,
        20595433,
        20595434,
        20595435,
        20595436,
        20595437,
        20595438,
        20595440,
        20595441,
        20595442,
        20595443,
        20595444,
        20595445,
        20595446,
        20595447,
        20595448,
        20595450,
        20595451,
        20595452,
        20595453,
        20595454,
        20595455,
        20595456,
        20595457,
        20595458,
        20595459,
        20595460,
        20595461,
        20595462,
        20595463,
        20595464,
        20595465,
        20595466,
        20595467,
        20595468,
        20595469,
        20595470,
        20595471,
        20595472,
        20595473,
        20595474,
        20595475,
        20595476,
        20595477,
        20595478,
        20595479,
        20595480,
        20595481,
        20595482,
        20595483,
        20595484,
        20595485,
        20595486,
        20595487,
        20595488,
        20595489,
        20595490,
        20595491,
        20595492,
        20595493,
        20595494,
        20595495,
        20595496,
        20595497,
        20595498,
        20595499,
        20595500,
        20595501,
        20595502,
        20595503,
        20595504,
        20595505,
        20595506,
        20595507,
        20595508,
        20595509,
        20595510,
        20595511,
        20595512,
        20595513,
        20595514,
        20595515,
        20595516,
        20595517,
        20595518,
        20595519,
        20595520,
        20595521,
        20595522,
        20595523,
        20595524,
        20595525,
        20595526,
        20595527,
        20595528,
        20595529,
        20595530,
        20595531,
        20595532,
        20595533,
        20595534,
        20595535,
        20595536,
        20595537,
        20595538,
        20595539,
        20595540,
        20595541,
        20595542,
        20595543,
        20595544,
        20595545,
        20595546,
        20595547,
        20595548,
        20595549,
        20595550,
        20595551,
        20595552,
        20595553,
        20595554,
        20595555,
        20595556,
        20595557,
        20595558,
        20595559,
        20595560,
        20595561,
        20595562,
        20595563,
        20595564,
        20595565,
        20595566,
        20595567,
        20595568,
        20595572,
        20595573,
        20595574,
        20595575,
        20595576,
        20595577,
        20595578,
        20595579,
        20595580,
        20595581,
        20595582,
        20595583,
        20595584,
        20595585,
        20595586,
        20595587,
        20595588,
        20595589,
        20595590,
        20595591,
        20595592,
        20595593,
        20595594,
        20595595,
        20595596,
        20595597,
        20595598,
        20595599,
        20595600,
        20595601,
        20595602,
        20595603,
        20595604,
        20595605,
        20595606,
        20595607,
        20595608,
        20595609,
        20595610,
        20595611,
        20595612,
        20595613,
        20595614,
        20595615,
        20595617,
        20595618,
        20595619,
        20595620,
        20595621,
        20595622,
        20595623,
        20595624,
        20595625,
        20595626,
        20595627,
        20595628,
        20595629,
        20595630,
        20595631,
        20595632,
        20595633,
        20595634,
        20595635,
        20595636,
        20595637,
        20595638,
        20595639,
        20595640,
        20595641,
        20595642,
        20595643,
        20595644,
        20595645,
        20595646,
        20595647,
        20595648,
        20595649,
        20595650,
        20595651,
        20595652,
        20595653,
        20595654,
        20595655,
        20595656,
        20595657,
        20595658,
        20595659,
        20595660,
        20595661,
        20595662,
        20595663,
        20595664,
        20595665,
        20595666,
        20595667,
        20595668,
        20595669,
        20595670,
        20595671,
        20595672,
        20595673,
        20595674,
        20595675,
        20595676,
        20595677,
        20595678,
        20595679,
        20595680,
        20595681,
        20595682,
        20595683,
        20595684,
        20595685,
        20595686,
        20595687,
        20595688,
        20595689,
        20595690,
        20595691,
        20595692,
        20595693,
        20595694,
        20595695,
        20595696,
        20595697,
        20595698,
        20595699,
        20595700,
        20595701,
        20595702,
        20595703,
        20595704,
        20595706,
        20595707,
        20595708,
        20595709,
        20595710,
        20595711,
        20595712,
        20595713,
        20595714,
        20595715,
        20595716,
        20595717,
        20595718,
        20595719,
        20595720,
        20595721,
        20595722,
        20595723,
        20595743,
        20595744,
        20595745,
        20595746,
        20595747,
        20595748,
        20595749,
        20595750,
        20595751,
        20595752,
        20595753,
        20595754,
        20595755,
        20595756,
        20595757,
        20595758,
        20595759,
        20595760,
        20595761,
        20595762,
        20595763,
        20595764,
        20595765,
        20595766,
        20595767,
        20595768,
        20595769,
        20595770,
        20595771,
        20595773,
        20595774,
        20595775,
        20595776,
        20595777,
        20595778,
        20595779,
        20595780,
        20595781,
        20595782,
        20595783,
        20595784,
        20595785,
        20595786,
        20595787,
        20595788,
        20595789,
        20595790,
        20595791,
        20595792,
        20595793,
        20595794,
        20595795,
        20595796,
        20595797,
        20595798,
        20595799,
        20595800,
        20595801,
        20595802,
        20595803,
        20595804,
        20595805,
        20595806,
        20595807,
        20595808,
        20595809,
        20595810,
        20595811,
        20595812,
        20595813,
        20595814,
        20595815,
        20595816,
        20595817,
        20595818,
        20595819,
        20595820,
        20595821,
        20595822,
        20595823,
        20595824,
        20595825,
        20595826,
        20595827,
        20595828,
        20595829,
        20595830,
        20595831,
        20595832,
        20595833,
        20595834,
        20595835,
        20595836,
        20595837,
        20595838,
        20595839,
        20595840,
        20595841,
        20595842,
        20595843,
        20595844,
        20595845,
        20595846,
        20595847,
        20595848,
        20595849,
        20595850,
        20595851,
        20595852,
        20595853,
        20595854,
        20595855,
        20595856,
        20595857,
        20595858,
        20595859,
        20595860,
        20595861,
        20595862,
        20595863,
        20595864,
        20595865,
        20595866,
        20595867,
        20595868,
        20595869,
        20595870,
        20595871,
        20595872,
        20595873,
        20595874,
        20595875,
        20595876,
        20595877,
        20595878,
        20595879,
        20595880,
        20595881,
        20595882,
        20595883,
        20595884,
        20595885,
        20595886,
        20595887,
        20595888,
        20595889,
        20595890,
        20595891,
        20595892,
        20595894,
        20595909,
        20595910,
        20595911,
        20595912,
        20595913,
        20595914,
        20595915,
        20595916,
        20595917,
        20595918,
        20595919,
        20595920,
        20595921,
        20595922,
        20595923,
        20595924,
        20595925,
        20595926,
        20595927,
        20595928,
        20595929,
        20595930,
        20595931,
        20595932,
        20595933,
        20595934,
        20595935,
        20595936,
        20595937,
        20595938,
        20595939,
        20595940,
        20595941,
        20595942,
        20595943,
        20595944,
        20595945,
        20595946,
        20595947,
        20595948,
        20595949,
        20595950,
        20595951,
        20595952,
        20595953,
        20595954,
        20595955,
        20595956,
        20595957,
        20595958,
        20595959,
        20595960,
        20595961,
        20595962,
        20595963,
        20595964,
        20595965,
        20595966,
        20595967,
        20595968,
        20595969,
        20595970,
        20595971,
        20595972,
        20595973,
        20595974,
        20595975,
        20595976,
        20595977,
        20595978,
        20595979,
        20595980,
        20595981,
        20595982,
        20595983,
        20595985,
        20595986,
        20595987,
        20595988,
        20595989,
        20595990,
        20595991,
        20595992,
        20595993,
        20595995,
        20595996,
        20595997,
        20595998,
        20595999,
        20596000,
        20596001,
        20596002,
        20596003,
        20596005,
        20596006,
        20596007,
        20596008,
        20596009,
        20596010,
        20596011,
        20596012,
        20596013,
        20596014,
        20596015,
        20596016,
        20596017,
        20596018,
        20596020,
        20596021,
        20596022,
        20596023,
        20596024,
        20596025,
        20596026,
        20596027,
        20596028,
        20596029,
        20596030,
        20596031,
        20596032,
        20596033,
        20596034,
        20596035,
        20596036,
        20596037,
        20596038,
        20596039,
        20596040,
        20596042,
        20596043,
        20596044,
        20596045,
        20596046,
        20596047,
        20596048,
        20596049,
        20596050,
        20596052,
        20596053,
        20596054,
        20596055,
        20596056,
        20596057,
        20596058,
        20596059,
        20596060,
        20596061,
        20596062,
        20596063,
        20596064,
        20596066,
        20596067,
        20596068,
        20596069,
        20596070,
        20596071,
        20596072,
        20596073,
        20596074,
        20596075,
        20596076,
        20596077,
        20596078,
        20596079,
        20596080,
        20596081,
        20596082,
        20596083,
        20596084,
        20596085,
        20596086,
        20596087,
        20596088,
        20596089,
        20596090,
        20596091,
        20596092,
        20596093,
        20596094,
        20596095,
        20596096,
        20596097,
        20596098,
        20596099,
        20596100,
        20596101,
        20596102,
        20596103,
        20596104,
        20596105,
        20596106,
        20596107,
        20596108,
        20596109,
        20596110,
        20596111,
        20596112,
        20596113,
        20596114,
        20596115,
        20596116,
        20596117,
        20596118,
        20596119,
        20596120,
        20596121,
        20596122,
        20596123,
        20596124,
        20596125,
        20596126,
        20596127,
        20596128,
        20596129,
        20596130,
        20596131,
        20596132,
        20596133,
        20596134,
        20596135,
        20596136,
        20596137,
        20596138,
        20596139,
        20596140,
        20596141,
        20596142,
        20596143,
        20596144,
        20596145,
        20596146,
        20596147,
        20596148,
        20596149,
        20596150,
        20596151,
        20596152,
        20596153,
        20596154,
        20596155,
        20596156,
        20596157,
        20596158,
        20596159,
        20596160,
        20596161,
        20596162,
        20596163,
        20596164,
        20596165,
        20596166,
        20596167,
        20596168,
        20596169,
        20596170,
        20596171,
        20596172,
        20596173,
        20596174,
        20596175,
        20596176,
        20596177,
        20596178,
        20596179,
        20596180,
        20596181,
        20596182,
        20596183,
        20596184,
        20596185,
        20596186,
        20596187,
        20596188,
        20596189,
        20596190,
        20596191,
        20596192,
        20596193,
        20596194,
        20596195,
        20596196,
        20596197,
        20596198,
        20596199,
        20596200,
        20596201,
        20596202,
        20596203,
        20596204,
        20596205,
        20596206,
        20596207,
        20596208,
        20596209,
        20596210,
        20596211,
        20596212,
        20596213,
        20596214,
        20596215,
        20596216,
        20596217,
        20596218,
        20596219,
        20596220,
        20596221,
        20596222,
        20596223,
        20596224,
        20596225,
        20596226,
        20596227,
        20596228,
        20596230,
        20596231,
        20596232,
        20596233,
        20596234,
        20596235,
        20596236,
        20596237,
        20596238,
        20596239,
        20596240,
        20596241,
        20596242,
        20596243,
        20596244,
        20596245,
        20596246,
        20596247,
        20596248,
        20596249,
        20596250,
        20596251,
        20596252,
        20596253,
        20596254,
        20596255,
        20596256,
        20596257,
        20596258,
        20596259,
        20596260,
        20596261,
        20596262,
        20596263,
        20596265,
        20596266,
        20596267,
        20596268,
        20596269,
        20596270,
        20596271,
        20596272,
        20596273,
        20596274,
        20596275,
        20596276,
        20596277,
        20596278,
        20596279,
        20596280,
        20596281,
        20596282,
        20596283,
        20596284,
        20596285,
        20596286,
        20596287,
        20596288,
        20596289,
        20596290,
        20596291,
        20596292,
        20596293,
        20596294,
        20596295,
        20596296,
        20596297,
        20596298,
        20596299,
        20596300,
        20596301,
        20596302,
        20596303,
        20596304,
        20596305,
        20596306,
        20596307,
        20596308,
        20596309,
        20596310,
        20596311,
        20596312,
        20596313,
        20596314,
        20596315,
        20596316,
        20596317,
        20596318,
        20596319,
        20596320,
        20596321,
        20596322,
        20596323,
        20596324,
        20596325,
        20596326,
        20596327,
        20596328,
        20596329,
        20596330,
        20596331,
        20596332,
        20596333,
        20596334,
        20596335,
        20596336,
        20596337,
        20596338,
        20596339,
        20596340,
        20596341,
        20596342,
        20596343,
        20596344,
        20596345,
        20596347,
        20596348,
        20596349,
        20596350,
        20596351,
        20596352,
        20596353,
        20596354,
        20596355,
        20596356,
        20596357,
        20596358,
        20596359,
        20596360,
        20596361,
        20596362,
        20596364,
        20596365,
        20596366,
        20596367,
        20596368,
        20596369,
        20596370,
        20596371,
        20596372,
        20596373,
        20596374,
        20596375,
        20596376,
        20596377,
        20596378,
        20596379,
        20596380,
        20596381,
        20596382,
        20596383,
        20596384,
        20596385,
        20596386,
        20596387,
        20596388,
        20596389,
        20596390,
        20596391,
        20596392,
        20596393,
        20596394,
        20596395,
        20596396,
        20596397,
        20596398,
        20596399,
        20596400,
        20596401,
        20596402,
        20596403,
        20596404,
        20596405,
        20596406,
        20596407,
        20596408,
        20596409,
        20596410,
        20596411,
        20596412,
        20596413,
        20596414,
        20596415,
        20596416,
        20596417,
        20596418,
        20596419,
        20596422,
        20596423,
        20596424,
        20596425,
        20596426,
        20596427,
        20596428,
        20596429,
        20596430,
        20596431,
        20596432,
        20596433,
        20596434,
        20596435,
        20596436,
        20596437,
        20596438,
        20596439,
        20596440,
        20596441,
        20596442,
        20596443,
        20596444,
        20596445,
        20596446,
        20596447,
        20596448,
        20596449,
        20596450,
        20596451,
        20596452,
        20596453,
        20596454,
        20596455,
        20596456,
        20596457,
        20596458,
        20596459,
        20596460,
        20596461,
        20596462,
        20596463,
        20596464,
        20596465,
        20596466,
        20596467,
        20596468,
        20596469,
        20596470,
        20596471,
        20596472,
        20596473,
        20596474,
        20596475,
        20596477,
        20596478,
        20596479,
        20596480,
        20596481,
        20596482,
        20596483,
        20596484,
        20596485,
        20596486,
        20596487,
        20596488,
        20596489,
        20596490,
        20596491,
        20596492,
        20596493,
        20596494,
        20596495,
        20596496,
        20596497,
        20596498,
        20596499,
        20596500,
        20596501,
        20596502,
        20596503,
        20596504,
        20596505,
        20596506,
        20596507,
        20596508,
        20596509,
        20596510,
        20596511,
        20596512,
        20596513,
        20596514,
        20596515,
        20596516,
        20596517,
        20596518,
        20596519,
        20596520,
        20596521,
        20596522,
        20596523,
        20596524,
        20596525,
        20596526,
        20596527,
        20596528,
        20596529,
        20596530,
        20596531,
        20596532,
        20596533,
        20596534,
        20596535,
        20596536,
        20596537,
        20596538,
        20596539,
        20596540,
        20596541,
        20596542,
        20596543,
        20596544,
        20596545,
        20596546,
        20596547,
        20596548,
        20596549,
        20596550,
        20596551,
        20596552,
        20596553,
        20596554,
        20596555,
        20596556,
        20596557,
        20596558,
        20596559,
        20596560,
        20596561,
        20596562,
        20596563,
        20596564,
        20596565,
        20596566,
        20596567,
        20596568,
        20596569,
        20596570,
        20596571,
        20596572,
        20596573,
        20596574,
        20596575,
        20596576,
        20596577,
        20596578,
        20596579,
        20596580,
        20596581,
        20596582,
        20596583,
        20596584,
        20596585,
        20596586,
        20596587,
        20596588,
        20596589,
        20596590,
        20596591,
        20596592,
        20596593,
        20596594,
        20596595,
        20596596,
        20596597,
        20596598,
        20596599,
        20596600,
        20596601,
        20596602,
        20596603,
        20596604,
        20596605,
        20596606,
        20596607,
        20596608,
        20596609,
        20596610,
        20596611,
        20596612,
        20596613,
        20596615,
        20596616,
        20596617,
        20596618,
        20596619,
        20596620,
        20596621,
        20596623,
        20596624,
        20596626,
        20596627,
        20596628,
        20596629,
        20596630,
        20596631,
        20596632,
        20596633,
        20596634,
        20596635,
        20596636,
        20596637,
        20596638,
        20596639,
        20596640,
        20596641,
        20596642,
        20596643,
        20596644,
        20596645,
        20596646,
        20596647,
        20596648,
        20596649,
        20596650,
        20596651,
        20596652,
        20596653,
        20596654,
        20596655,
        20596656,
        20596657,
        20596658,
        20596659,
        20596660,
        20596661,
        20596662,
        20596663,
        20596664,
        20596665,
        20596666,
        20596667,
        20596668,
        20596669,
        20596670,
        20596671,
        20596672,
        20596673,
        20596674,
        20596675,
        20596676,
        20596677,
        20596678,
        20596679,
        20596680,
        20596681,
        20596682,
        20596683,
        20596684,
        20596685,
        20596686,
        20596687,
        20596688,
        20596689,
        20596690,
        20596691,
        20596692,
        20596693,
        20596694,
        20596695,
        20596696,
        20596697,
        20596698,
        20596699,
        20596700,
        20596701,
        20596702,
        20596703,
        20596704,
        20596705,
        20596706,
        20596707,
        20596708,
        20596709,
        20596710,
        20596711,
        20596712,
        20596713,
        20596714,
        20596715,
        20596716,
        20596717,
        20596718,
        20596719,
        20596720,
        20596721,
        20596722,
        20596723,
        20596724,
        20596725,
        20596726,
        20596727,
        20596728,
        20596729,
        20596730,
        20596731,
        20596732,
        20596733,
        20596734,
        20596735,
        20596736,
        20596737,
        20596738,
        20596739,
        20596740,
        20596741,
        20596742,
        20596743,
        20596744,
        20596745,
        20596746,
        20596747,
        20596748,
        20596749,
        20596750,
        20596751,
        20596752,
        20596753,
        20596755,
        20596756,
        20596757,
        20596758,
        20596759,
        20596760,
        20596761,
        20596762,
        20596763,
        20596764,
        20596765,
        20596766,
        20596767,
        20596768,
        20596769,
        20596770,
        20596771,
        20596772,
        20596773,
        20596774,
        20596775,
        20596776,
        20596778,
        20596779,
        20596780,
        20596781,
        20596782,
        20596783,
        20596784,
        20596785,
        20596786,
        20596787,
        20596788,
        20596789,
        20596790,
        20596791,
        20596792,
        20596793,
        20596794,
        20596795,
        20596796,
        20596797,
        20596798,
        20596799,
        20596800,
        20596801,
        20596802,
        20596803,
        20596805,
        20596806,
        20596807,
        20596808,
        20596809,
        20596810,
        20596811,
        20596812,
        20596813,
        20596814,
        20596815,
        20596816,
        20596817,
        20596818,
        20596819,
        20596820,
        20596821,
        20596822,
        20596823,
        20596824,
        20596825,
        20596826,
        20596828,
        20596829,
        20596830,
        20596831,
        20596832,
        20596833,
        20596834,
        20596835,
        20596836,
        20596837,
        20596838,
        20596839,
        20596840,
        20596841,
        20596842,
        20596843,
        20596844,
        20596845,
        20596846,
        20596847,
        20596848,
        20596849,
        20596850,
        20596851,
        20596852,
        20596853,
        20596854,
        20596855,
        20596856,
        20596857,
        20596858,
        20596859,
        20596860,
        20596861,
        20596862,
        20596863,
        20596864,
        20596865,
        20596866,
        20596867,
        20596868,
        20596869,
        20596870,
        20596871,
        20596872,
        20596873,
        20596874,
        20596875,
        20596876,
        20596877,
        20596878,
        20596879,
        20596880,
        20596881,
        20596882,
        20596883,
        20596884,
        20596885,
        20596886,
        20596887,
        20596888,
        20596889,
        20596890,
        20596892,
        20596893,
        20596894,
        20596895,
        20596896,
        20596897,
        20596898,
        20596899,
        20596900,
        20596901,
        20596902,
        20596903,
        20596904,
        20596905,
        20596906,
        20596907,
        20596908,
        20596909,
        20596910,
        20596911,
        20596912,
        20596913,
        20596914,
        20596915,
        20596916,
        20596917,
        20596918,
        20596919,
        20596920,
        20596921,
        20596922,
        20596923,
        20596924,
        20596925,
        20596926,
        20596927,
        20596928,
        20596929,
        20596930,
        20596931,
        20596932,
        20596933,
        20596934,
        20596935,
        20596936,
        20596937,
        20596938,
        20596939,
        20596940,
        20596941,
        20596942,
        20596943,
        20596944,
        20596945,
        20596946,
        20596947,
        20596948,
        20596949,
        20596950,
        20596951,
        20596952,
        20596953,
        20596954,
        20596955,
        20596956,
        20596957,
        20596958,
        20596959,
        20596961,
        20596962,
        20596963,
        20596964,
        20596965,
        20596966,
        20596967,
        20596968,
        20596970,
        20596971,
        20596972,
        20596973,
        20596974,
        20596975,
        20596976,
        20596977,
        20596978,
        20596979,
        20596980,
        20596981,
        20596982,
        20596983,
        20596984,
        20596985,
        20596986,
        20596987,
        20596988,
        20596989,
        20596990,
        20596991,
        20596992,
        20596993,
        20596994,
        20596995,
        20596996,
        20596997,
        20596998,
        20596999,
        20597000,
        20597001,
        20597002,
        20597003,
        20597004,
        20597005,
        20597006,
        20597007,
        20597008,
        20597009,
        20597010,
        20597011,
        20597012,
        20597013,
        20597014,
        20597015,
        20597016,
        20597017,
        20597018,
        20597019,
        20597020,
        20597021,
        20597022,
        20597023,
        20597024,
        20597025,
        20597026,
        20597027,
        20597028,
        20597029,
        20597030,
        20597031,
        20597032,
        20597033,
        20597034,
        20597035,
        20597036,
        20597037,
        20597038,
        20597039,
        20597040,
        20597041,
        20597042,
        20597043,
        20597044,
        20597045,
        20597046,
        20597047,
        20597048,
        20597049,
        20597050,
        20597051,
        20597052,
        20597053,
        20597054,
        20597055,
        20597056,
        20597058,
        20597059,
        20597061,
        20597062,
        20597063,
        20597064,
        20597065,
        20597066,
        20597067,
        20597068,
        20597069,
        20597070,
        20597071,
        20597072,
        20597073,
        20597074,
        20597075,
        20597076,
        20597077,
        20597078,
        20597079,
        20597080,
        20597081,
        20597082,
        20597083,
        20597084,
        20597085,
        20597086,
        20597087,
        20597088,
        20597089,
        20597090,
        20597091,
        20597092,
        20597093,
        20597094,
        20597095,
        20597096,
        20597097,
        20597098,
        20597099,
        20597100,
        20597101,
        20597102,
        20597103,
        20597104,
        20597105,
        20597106,
        20597107,
        20597108,
        20597109,
        20597110,
        20597111,
        20597112,
        20597113,
        20597114,
        20597115,
        20597116,
        20597117,
        20597118,
        20597119,
        20597120,
        20597121,
        20597122,
        20597123,
        20597124,
        20597125,
        20597126,
        20597127,
        20597128,
        20597129,
        20597130,
        20597131,
        20597132,
        20597133,
        20597134,
        20597136,
        20597137,
        20597138,
        20597139,
        20597140,
        20597141,
        20597142,
        20597143,
        20597144,
        20597145,
        20597146,
        20597147,
        20597148,
        20597149,
        20597150,
        20597151,
        20597152,
        20597153,
        20597154,
        20597155,
        20597156,
        20597157,
        20597158,
        20597159,
        20597160,
        20597161,
        20597162,
        20597163,
        20597164,
        20597165,
        20597166,
        20597167,
        20597168,
        20597169,
        20597170,
        20597171,
        20597172,
        20597173,
        20597174,
        20597175,
        20597176,
        20597177,
        20597178,
        20597179,
        20597180,
        20597181,
        20597182,
        20597183,
        20597184,
        20597185,
        20597186,
        20597187,
        20597188,
        20597189,
        20597190,
        20597191,
        20597192,
        20597193,
        20597194,
        20597195,
        20597196,
        20597197,
        20597198,
        20597199,
        20597200,
        20597201,
        20597202,
        20597203,
        20597204,
        20597205,
        20597206,
        20597207,
        20597208,
        20597209,
        20597210,
        20597211,
        20597212,
        20597213,
        20597214,
        20597215,
        20597216,
        20597217,
        20597218,
        20597219,
        20597220,
        20597221,
        20597222,
        20597223,
        20597224,
        20597225,
        20597226,
        20597227,
        20597228,
        20597229,
        20597230,
        20597231,
        20597232,
        20597233,
        20597234,
        20597235,
        20597236,
        20597237,
        20597238,
        20597239,
        20597240,
        20597241,
        20597242,
        20597243,
        20597244,
        20597245,
        20597247,
        20597248,
        20597249,
        20597250,
        20597251,
        20597252,
        20597253,
        20597254,
        20597255,
        20597256,
        20597257,
        20597258,
        20597259,
        20597260,
        20597261,
        20597263,
        20597264,
        20597265,
        20597266,
        20597267,
        20597268,
        20597269,
        20597270,
        20597271,
        20597272,
        20597273,
        20597274,
        20597275,
        20597276,
        20597277,
        20597278,
        20597279,
        20597280,
        20597281,
        20597282,
        20597283,
        20597284,
        20597285,
        20597286,
        20597287,
        20597288,
        20597289,
        20597290,
        20597291,
        20597292,
        20597293,
        20597294,
        20597295,
        20597296,
        20597297,
        20597298,
        20597299,
        20597300,
        20597301,
        20597302,
        20597303,
        20597304,
        20597305,
        20597306,
        20597307,
        20597308,
        20597309,
        20597310,
        20597311,
        20597312,
        20597313,
        20597314,
        20597315,
        20597316,
        20597317,
        20597318,
        20597319,
        20597320,
        20597322,
        20597323,
        20597324,
        20597325,
        20597326,
        20597327,
        20597328,
        20597329,
        20597331,
        20597332,
        20597333,
        20597334,
        20597335,
        20597336,
        20597337,
        20597338,
        20597339,
        20597341,
        20597342,
        20597343,
        20597344,
        20597345,
        20597346,
        20597347,
        20597348,
        20597349,
        20597350,
        20597351,
        20597352,
        20597353,
        20597354,
        20597355,
        20597356,
        20597357,
        20597358,
        20597359,
        20597360,
        20597361,
        20597362,
        20597363,
        20597364,
        20597365,
        20597366,
        20597368,
        20597369,
        20597370,
        20597371,
        20597372,
        20597373,
        20597375,
        20597376,
        20597377,
        20597378,
        20597379,
        20597380,
        20597381,
        20597382,
        20597383,
        20597384,
        20597385,
        20597386,
        20597387,
        20597388,
        20597389,
        20597390,
        20597391,
        20597392,
        20597393,
        20597394,
        20597395,
        20597396,
        20597397,
        20597398,
        20597399,
        20597400,
        20597401,
        20597402,
        20597403,
        20597404,
        20597405,
        20597406,
        20597407,
        20597408,
        20597409,
        20597410,
        20597411,
        20597412,
        20597413,
        20597414,
        20597415,
        20597416,
        20597417,
        20597418,
        20597419,
        20597420,
        20597421,
        20597422,
        20597423,
        20597424,
        20597425,
        20597426,
        20597427,
        20597428,
        20597429,
        20597430,
        20597431,
        20597432,
        20597433,
        20597434,
        20597435,
        20597436,
        20597437,
        20597438,
        20597439,
        20597440,
        20597441,
        20597442,
        20597443,
        20597444,
        20597445,
        20597446,
        20597447,
        20597448,
        20597449,
        20597450,
        20597451,
        20597452,
        20597453,
        20597454,
        20597455,
        20597456,
    ];

    try {
        const masterConnection = await connectToSqlServer();
        await masterConnection.query('USE CONTABIL2024');

        for (const id of idsParaExcluir) {
            const deletePayload = [
                {
                    idIntegracao: id.toString(),
                    idGerado: { id: id },
                    content: { exercicio: 2024 }
                }
            ];

            console.log(JSON.stringify(deletePayload));

            const response = await fetch('https://con-sl-rest.betha.cloud/contabil/service-layer/v2/api/empenhos', {
                method: 'DELETE',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': 'Bearer 25a840ae-b57a-4030-903a-bcccf2386f30'
                },
                body: JSON.stringify(deletePayload)
            });

            const responseText = await response.text();
            const responseDetails = {
                status: response.status,
                statusText: response.statusText,
                responseBody: responseText,
            };

            console.log(`Resposta da API para ID ${id}:`, responseDetails);

            if (response.ok) {
                console.log(`Registro com ID ${id} excluído com sucesso.`);
            } else {
                console.error(`Erro ao excluir o registro com ID ${id}:`, responseDetails);
            }

            // Registrar a resposta no log
            await logResponse(id, responseDetails);
        }
    } catch (error) {
        console.error('Erro durante a execução do programa:', error);
    } finally {
        await sql.close();
    }
}

// Executar o programa
main();